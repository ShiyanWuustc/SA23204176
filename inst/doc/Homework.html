<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Shiyan Wu" />

<meta name="date" content="2023-11-27" />

<title>Homework From SA23204176</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework From SA23204176</h1>
<h4 class="author">Shiyan Wu</h4>
<h4 class="date">2023-11-27</h4>



<div id="hw0" class="section level1">
<h1><strong>HW0</strong></h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples. For each example,texts
should mix with figures and/or tables. Better to have mathematical
formulas. ## Answer
本文将使用4个例子进行R语言的训练。分别包括基础图形的绘制、基础运算、回归分析和创建经验分布。
## Example 1 绘图 在Example
1中，本文将绘制一些基础图形，包括条形图、饼图、Q-Q图、散点图、气泡图、核密度图、直方图和箱线图等，并组合成为一张图片输出<br />
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)       <span class="co">#随机种子</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>)     </span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>),<span class="dv">3</span>,<span class="dv">3</span>,<span class="at">byrow=</span>T),<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">0.5</span>), <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.5</span><span class="sc">:</span><span class="fl">0.5</span>))</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mai=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.3</span>,<span class="fl">0.15</span>,<span class="fl">0.45</span>), <span class="at">cex.main=</span><span class="fl">0.9</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">runif</span>(<span class="dv">8</span>,<span class="dv">1</span>,<span class="dv">8</span>),<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">main=</span><span class="st">&#39;条形图&#39;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">pie</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">6</span>), <span class="at">labels=</span><span class="st">&#39;&#39;</span>, <span class="at">border=</span><span class="cn">NA</span>, <span class="at">main=</span><span class="st">&#39;饼图&#39;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">xlab=</span><span class="st">&#39;&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;&#39;</span>, <span class="at">main=</span><span class="st">&#39;散点图&#39;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>), <span class="fu">rnorm</span>(<span class="dv">25</span>), <span class="at">cex=</span>(y<span class="sc">+</span><span class="dv">2</span>), <span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&#39;&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;&#39;</span>, <span class="at">main=</span><span class="st">&#39;气泡图&#39;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(y), <span class="at">col=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">xlab=</span><span class="st">&#39;&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;&#39;</span>, <span class="at">main=</span><span class="st">&#39;核密度图&#39;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rnorm</span>(<span class="dv">500</span>), <span class="at">col=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">&#39;&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;&#39;</span>, <span class="at">main=</span><span class="st">&#39;直方图&#39;</span>)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">boxplot</span>(x, <span class="at">col=</span><span class="dv">2</span>, <span class="at">main=</span><span class="st">&#39;箱线图&#39;</span>)</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="fu">qqnorm</span>(y, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">xlab=</span><span class="st">&#39;&#39;</span>, <span class="at">ylab=</span><span class="st">&#39;&#39;</span>,<span class="at">main=</span><span class="st">&#39;Q-Q图&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="example-2-基础运算" class="section level2">
<h2>Example 2 基础运算</h2>
<p>在Example
2中，本文将进行一些基础运算，包括集合的运算、求导数、复合函数求导法则、求微分以及求定积分<br />
1、集合的运算：实现集合A和B的并、交、差计算</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>)  </span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)  </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">union</span>(A, B)  <span class="co"># 求集合A与B的并集</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">intersect</span>(A, B)  <span class="co"># 求集合A与B的交集</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">setdiff</span>(A, B)  <span class="co"># 求集合A与B的差(A-B)</span></span></code></pre></div>
<pre><code>## [1] 1 2 4 5 3
## [1] 2
## [1] 1 4 5</code></pre>
<p>2、求导数：求反正弦函数<span class="math inline">\(y=\arcsin(x)\)</span>的导数</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>(f <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">asin</span>(x)))</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">D</span>(f, <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<pre><code>## expression(asin(x))
## 1/sqrt(1 - x^2)</code></pre>
<p>3、复合函数求导法则：若<span class="math inline">\(y=\ln\cos(ex)\)</span>，求<span class="math inline">\(\frac{dy}{dx}\)</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>(f <span class="ot">&lt;-</span> <span class="fu">expression</span>(<span class="fu">log</span>(<span class="fu">cos</span>(<span class="fu">exp</span>(x)))))</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">D</span>(f, <span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<pre><code>## expression(log(cos(exp(x))))
## -(sin(exp(x)) * exp(x)/cos(exp(x)))</code></pre>
<p>4、求微分：若<span class="math inline">\(y=\ln(x+\sqrt{x^2+1})\)</span>，求<span class="math inline">\(dy\)</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">library</span>(Deriv)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">log</span>(x <span class="sc">+</span> <span class="fu">sqrt</span>(x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>(dy <span class="ot">&lt;-</span> <span class="fu">Deriv</span>(f, <span class="st">&quot;x&quot;</span>))</span></code></pre></div>
<pre><code>## function (x) 
## {
##     .e2 &lt;- sqrt(1 + x^2)
##     (1 + x/.e2)/(.e2 + x)
## }</code></pre>
<p>5、求定积分：求<span class="math inline">\(\int_{0}^{\pi}\sin(x)dx\)</span>和<span class="math inline">\(\int_{0}^{5}\ln(x)dx\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sin</span>(x)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f, <span class="at">lower=</span><span class="dv">0</span>, <span class="at">upper=</span>pi)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>result[[<span class="st">&quot;value&quot;</span>]]</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">log</span>(x)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(f, <span class="at">lower=</span><span class="dv">0</span>, <span class="at">upper=</span><span class="dv">5</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>result[[<span class="st">&quot;value&quot;</span>]]</span></code></pre></div>
<pre><code>## [1] 2
## [1] 3.04719</code></pre>
</div>
<div id="example-3-回归分析" class="section level2">
<h2>Example 3 回归分析</h2>
<p>在Example
3中，本文将使用gcookbook包中的heightweight数据，进行一元线性回归分析。
1、数据获取</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">library</span>(gcookbook)                    </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(heightweight)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sum)<span class="co">#数据可视化</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">sex</th>
<th align="left">ageYear</th>
<th align="left">ageMonth</th>
<th align="left">heightIn</th>
<th align="left">weightLb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">f:111</td>
<td align="left">Min. :11.58</td>
<td align="left">Min. :139.0</td>
<td align="left">Min. :50.50</td>
<td align="left">Min. : 50.5</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">m:125</td>
<td align="left">1st Qu.:12.33</td>
<td align="left">1st Qu.:148.0</td>
<td align="left">1st Qu.:58.73</td>
<td align="left">1st Qu.: 85.0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">NA</td>
<td align="left">Median :13.58</td>
<td align="left">Median :163.0</td>
<td align="left">Median :61.50</td>
<td align="left">Median :100.5</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">NA</td>
<td align="left">Mean :13.67</td>
<td align="left">Mean :164.1</td>
<td align="left">Mean :61.34</td>
<td align="left">Mean :101.0</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">NA</td>
<td align="left">3rd Qu.:14.83</td>
<td align="left">3rd Qu.:178.0</td>
<td align="left">3rd Qu.:64.30</td>
<td align="left">3rd Qu.:112.0</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">NA</td>
<td align="left">Max. :17.50</td>
<td align="left">Max. :210.0</td>
<td align="left">Max. :72.00</td>
<td align="left">Max. :171.5</td>
</tr>
</tbody>
</table>
<p>2、建立回归方程</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(heightIn<span class="sc">~</span>ageYear,heightweight)     </span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">summary</span>(model) </span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = heightIn ~ ageYear, data = heightweight)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.3517 -1.9006  0.1378  1.9071  8.3371 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  37.4356     1.8281   20.48   &lt;2e-16 ***
## ageYear       1.7483     0.1329   13.15   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.989 on 234 degrees of freedom
## Multiple R-squared:  0.4249, Adjusted R-squared:  0.4225 
## F-statistic: 172.9 on 1 and 234 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>因此，该回归方程应表示为 <span class="math display">\[\hat{y}=37.4356+1.7483x\]</span>
3、回归方程可视化</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="do">## Warning: package &#39;ggplot2&#39; was built under R version 4.3.2</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x=</span>ageYear, <span class="at">y=</span>heightIn,<span class="at">color=</span><span class="st">&quot;#5e616d&quot;</span>))<span class="sc">+</span>      </span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span>                                                                     </span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span>                      </span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;R^2==0.4249&quot;</span>,<span class="at">parse=</span>T,<span class="at">x=</span><span class="dv">16</span>,<span class="at">y=</span><span class="dv">52</span>)<span class="sc">+</span>    </span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">label =</span> <span class="st">&quot;y_hat=37.4356+1.7483x&quot;</span>,<span class="at">x=</span><span class="dv">16</span>,<span class="at">y=</span><span class="dv">50</span>)  </span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="do">## `geom_smooth()` using formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="example-4-经验分布" class="section level2">
<h2>Example 4 经验分布</h2>
<p>在Example 4中，本文将根据一组<span class="math inline">\(X\)</span>的观测值建立其经验分布，并绘制其经验分布的图像。
定义：一组观测值<span class="math inline">\(X_1,X_2,...,X_n\)</span>的经验分布函数为 <span class="math display">\[F_n(x)=\frac{\#\{X_i:X_i\leq
x\}}{n}=\frac{1}{n}\sum^{n}_{i=1}I_{(-\infty,x]}(x)\]</span>
其中#{…}表示集合元素计数，<span class="math inline">\(I_A(x)\)</span>是集合<span class="math inline">\(A\)</span>的示性函数。<br />
1、创建经验分布</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">63</span>, <span class="dv">72</span>, <span class="dv">74</span>, <span class="dv">79</span>, <span class="dv">82</span>, <span class="dv">82</span>, <span class="dv">87</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">90</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co"># R的自定义函数</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>cdf_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(x) </span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x) </span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">c</span>(<span class="fu">table</span>(x))) <span class="co">#频数</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>pct <span class="ot">=</span> tab <span class="sc">/</span> n <span class="co">#频率</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( </span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="at">x =</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x)), <span class="co">#删掉重复值并排序</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="at">freq =</span> tab, <span class="co">#x中数值出现的频数(出现的次数)</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="at">pct =</span> pct, <span class="co">#x中数值对应的频率</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="at">cumfreq =</span> <span class="fu">cumsum</span>(tab), <span class="co">#频数的累加和</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="at">cumpct =</span> <span class="fu">cumsum</span>(pct)) <span class="co">#频率的累加和</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>d <span class="co">#返回d</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>}</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cdf_table</span>(scores))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">freq</th>
<th align="right">pct</th>
<th align="right">cumfreq</th>
<th align="right">cumpct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">63</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">1</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="right">72</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">2</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">74</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">3</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td align="right">79</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">4</td>
<td align="right">0.4</td>
</tr>
<tr class="odd">
<td align="right">82</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">6</td>
<td align="right">0.6</td>
</tr>
<tr class="even">
<td align="right">87</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">7</td>
<td align="right">0.7</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">8</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="right">90</td>
<td align="right">2</td>
<td align="right">0.2</td>
<td align="right">10</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
<p>2、绘制经验分布</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(scores) </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>dfreq <span class="ot">&lt;-</span> <span class="fu">cdf_table</span>(d<span class="sc">$</span>scores) <span class="co">#返回上述函数结果</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dfreq, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> cumpct )) </span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#对上图做进一步细化设定</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;step&quot;</span>) <span class="sc">+</span><span class="fu">scale_y_continuous</span>( <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">01</span>, <span class="fl">1.01</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),<span class="at">name =</span> <span class="st">&quot;累计百分比&quot;</span>) </span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAn1BMVEUAAAAAADoAAGYAOpAAZrYzMzM6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubqtuq8huq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T///+SO9TKAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHSElEQVR4nO2dC2ObNhSFWfdM2nXZI1mzrd2SLenS1Uuz+P//tllYRmAbHwkJCezvtCkEn8o3HxchCLquluigqtIBTF0AEgKQEICEACR0ENDjD/f18unq7NWHZnFaOgRocfayBvT89nr58O1mYfVPn/pfKeoKbcoD0N35H+sMenpzb5LJLgDkZHE8/vhh+fTzjV2sNny50qH/N19VjZoth+wW0OJVTcYu7GvJdlUml19TlfMHANrJIAB1AZ1QHzQM0PPby/VZ7PLoz2IDAJmvfeOgyEiOA9AhRUYCoCTxAiifC0BJmgKQEICEACQEICEACQFICEBCABICkBCAhAAkBCAhAAkBSAhAQgASApAQgIQAJJQQ0HFp55kF98rQJiN31cQyqNpxAagjAAEozgQgAMWZAASgOBOAABRnAhCA4kwAAlCcCUAAijMBCEBxJgABKM4EIADFmQAEoDgTgMYA1EwwfDgzuq6XL49zzuoQQN1CC2ZO+N01GdROoPYkZzMd/PndTevluHCPAVBnmrxJpdUhZw605VFUXqi21G/sfaVdaKFePn7fzqK4/Vk8gyrl0oDaGbRopoM3/VBcuMcAqN0H3V1utgKoUavQwvrAMmn0/PuRnOYTALLjoLrywvpIW42DzpsTWVy4RwHosOLCBVBgvOO7ABRmApAwAUiYACRMABImAAkTgIQJQMIEIGECkDABSJgiAB28AXnKgFpUALQ3g/ayAlDrZ/aroXzCgJpvANTXSVcAata2kPj9Fu10AYUrLtyZAqoCmMWFC6DAeMd3pTyLzbwaw/ZzCfvl3dqeb2beSe9PjtCmtgEF4/UNN79rHEDB8g03vwtAwgUg4RoTUAAu33Dzu0YEFJJOvuHmd40HKOhw8w03v2s0QGHdkW+4+V0jAaoHP0dxNT8KoKpzGcZAUZ3FPAj5hpvflQEQGcQ4SDa1jWTdCQXcB/ANN79rrAyqNl9zv2E25jgo4Jaib7j5XRlG0nTS6lqM0zxnMdXUACSnDSgYlG+4+V0AEq7xAAX9WsM33PyuEQFtvuc07wXIfbSzLbkwk896zgWoVXlhPZO3W4rBN9z8rlyA3KxnO1l+Lp83P97VfBeQmzdvSy64DROpvBD7XILfmzTLaguQq7xgSy60SzFMIoN2C24kfMNdQPa2fbOxU7vD9EPdDckiGe7KDai3D7KAJtcHFQbkKi/YkgutUgynCqjbz7nKC7bkwtTGQdkBBSlZJMNdAJoSoGAli2S4Kz+gmT3+AiAAxbkABKA4V05A4RfEySIZ7iKDABTnAtBEAc3m8ZdilxpzefwlL6D6pvS8pkPlv5qnD6KT9nYBSLiGMAEQgADk7doG5M7um19CA6gLyP7q2ZfPiQKq7Fpp+RVPyBLnVgZ5ps9y5AwKyo2sh1jlnT/JItmnKQJap6wBNIFrsSkCMn/sP+XPYlMFtE6gCZzFJguITtqtHQBU/obZFAG5kTSHWL22BagrOumJX6wCCEBx8QIIQHHxAghAcfECCEBx8QIIQHHxAghAcfECCEBx8QLoKAC5CYaPF2Za+KYAA4DWcoUWzFRnMzW8+Sh1ANVYmknOC4Pp7toWYACQVXea/GrNFmBYjlF5ocRjCX7qD6VTaMFMCbcFGOzLyXZVLfk5IAFtpWlKA2pn0NPVpd3a9EPJIqk1R0CtQguPF033DKBGrtCC5WMLMACoSaFN5QUz/jHdsy3AACAvJYukFoCEC0DCBSDhApBwAUi4ACRcABIuAAkXgIQLQMIFIOECkHABSLgAJFwAEi4ACReAhAtAwgUg4QKQcAFIuAAkXEcIyMmzTEL5IgqDlCCDqr6dkHKHRrsKHmIAAhCAdl0AEi4ACReAhAtAwgUg4QKQcAFIuAAkXAASLgAJF4CEC0DCBSDhApBwAUi4ACRcABIuAAkXgIQLQMIFIOHyAOQqL9i1ns96PlVArvKCXXMbAFSnTTPr2a71fd78qQJy8+btmttgKi/M4cGDFPKpvGDXOqUY+ncIGZREKWt/JGxrt6nBfVDySCbRVgggV3nBrrkNo0QyibZCALnKC3vHQckjmURbQYCQEYCEACQEICEACWUHtClGlOSU+HhRF3ZM0VZfU0UyaHXR0r01MFBmXP+Qpq2nq+v9TZUAZH6uJMPy+uLnTZIhvr2O2m2qBCCzi5Jc2NkMStFW7/VmAUB1AN1bA4ObqnuMFG3Vh9j5zW5TBQCZINJkkCl9uXh5n6ati7Of3k0jg+5M0cokfZDd36luM+ztzvIDWlc7TXJrwGZQirbq7mzfHYv8gGwGJxkHLdaVHVO0tWpq7x0LRtJCABICkBCAhAAkBCAhAAkBSAhAQrMA9P6z35afXn9T5L1nAWh5+4X5W0TzAPTvV79+/VeZt54HoOX76rtC7zwTQLdVoSNsJoA+vvjzdaEUmgWgTys6H1+U6YRmAej287+X//1S5iCbBaCSApAQgIQAJAQgIQAJAUgIQEIAEgKQ0P9o6COkDFT8HQAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /><br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw1" class="section level1">
<h1><strong>HW1</strong></h1>
<div id="exercises-1" class="section level2">
<h2><strong>Exercises 1</strong>:</h2>
<p><strong>Question：</strong><br />
利用逆变换法复现函数sample的部分功能（replace=TRUE),使用my.sample&lt;-function()的形式.</p>
<p><strong>Answer：</strong><br />
1、函数：<br />
实现思路：生成<span class="math inline">\(U\)</span>~<span class="math inline">\(U(0,1)\)</span>；返回<span class="math inline">\(X=x_i\)</span> if <span class="math inline">\(F_X(X_{i-1})&lt;U\le F_X(x_i).\)</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>my.sample <span class="ot">&lt;-</span> <span class="cf">function</span>(x,size,prob){</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(prob)){<span class="co">#判断是否指定概率分布</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>    p0 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(x)) </span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> <span class="fu">rep</span>(p0,<span class="fu">length</span>(x)) <span class="co">#若未指定概率分布，默认设置为等概率抽样  </span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  }</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(size)</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>]<span class="co">#抽样</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  ct <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(r))<span class="co">#计算频数</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">print</span>(ct<span class="sc">/</span><span class="fu">sum</span>(ct)<span class="sc">/</span>prob)<span class="co">#检验抽样频率与概率的关系：结果越接近1越好</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>}</span></code></pre></div>
<p>2、应用:<br />
函数提供两个结果，分别为抽样结果和抽样频率与概率比值（期望≈1）<br />
本文共抽样三次来展示函数，限于篇幅，抽取样本结果仅在第三次展示结果。</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>test1 <span class="ot">&lt;-</span> <span class="fu">my.sample</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size =</span> <span class="dv">1000</span>,<span class="at">prob =</span> <span class="cn">NULL</span>)<span class="co">#抽取对象：数字；无指定概率</span></span></code></pre></div>
<pre><code>##  [1] 0.84 0.95 1.14 1.03 0.94 0.98 1.05 1.11 0.86 1.10</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>test2 <span class="ot">&lt;-</span> <span class="fu">my.sample</span>(<span class="at">x=</span>letters,<span class="at">size =</span> <span class="dv">1000</span>,<span class="at">prob =</span> <span class="cn">NULL</span>)<span class="co">#抽取对象：字母；无指定概率</span></span></code></pre></div>
<pre><code>##  [1] 0.702 1.014 1.092 0.754 1.378 0.962 1.040 1.144 1.040 0.910 1.014 0.884
## [13] 0.962 0.728 1.040 0.832 1.014 1.144 0.962 1.170 1.066 0.884 1.222 0.884
## [25] 1.118 1.040</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>test3 <span class="ot">&lt;-</span> <span class="fu">my.sample</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),<span class="at">size =</span> <span class="dv">1000</span>,<span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span><span class="sc">/</span><span class="dv">55</span>))<span class="co">#抽取对象：字母；有指定概率</span></span></code></pre></div>
<pre><code>##  [1] 1.3750000 1.1275000 0.8616667 1.1550000 0.9900000 1.0083333 0.9742857
##  [8] 0.9831250 0.9044444 1.0340000</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>test3</span></code></pre></div>
<pre><code>##    [1]  9 10  7  4  6  6 10  4  6  9  9  4 10  9  8  8  1  2  7 10 10  8  4  6
##   [25]  6 10  9  8  7  9  9  7  5  6  3  9  6 10  7  3  2 10  9 10 10  4  7  6
##   [49]  9  2  6  7  5  2  2  5  4  4  5  4 10  8  1  5  2  8  8  4  4  7 10 10
##   [73] 10 10  9  9  5  8  7 10  6  7  7  3  7  8  9  9  8  5  8  1  8  7  4  7
##   [97]  4  8 10  4  3  8  4  3  4 10  9 10  7  9  7  5  8  9  8  1  6 10  8  6
##  [121]  3  9  8  8  7 10  8  8  7  7  8 10  6  4 10  1 10  9  8  1  8  6  2 10
##  [145]  8  9  8  9 10  8  9  4  8  6  4  8  5  6  2  9  7  9 10  8 10  7  8  4
##  [169] 10  8  5 10  5  9  7 10  6  6  5  5  2  7  5  4  9  8  5  7  5  9  1  6
##  [193]  6  8  8  9  5  7  9  5  6  4 10  7  8  8  9  5  2  4 10  5  5  6 10  6
##  [217]  9  9  9  6  9  9  2  6  8  6  8  8  4  6  2  4  7  9  4  9  8  6  7  5
##  [241]  2 10 10 10  1  9  6  3 10  9  9 10 10  4  9  6  5  9  8  8  7 10  9 10
##  [265]  8  7  5  6  8  4  9  3  5  3  7  8  2  5  9  9  9  7  6  5  9  6  4  9
##  [289]  4  7 10  5 10  8  8  3 10  7  3  6  7  8  7  6  6  7  7  9  8  4  3 10
##  [313] 10  5  5 10  9  9  8  6  9  7  5  7 10  9  7  5  3  2 10  6  2  6  7  5
##  [337]  9  7 10 10  7 10  5  3  6 10 10 10  9 10  9  5 10  9  6  7  7  9  5 10
##  [361] 10  6 10 10  8  9  7  7  3  2  9  6  9  7  3  7 10  8  6  6  9  3 10 10
##  [385]  6  5  6  6  8  4  8  8  4 10  8  9 10 10  3  4 10  4  5 10  9  7  5  7
##  [409] 10  4  3  9  7  9  2  8 10  8  6  9  7  4  4  7  8  3  4 10  8 10  4  7
##  [433]  8  5  6  8 10  4  6  8 10  4  1  9  6 10  1 10 10  6  7  7  5  9  9  9
##  [457] 10  9  3  9  7  8  9 10 10  3  6  8  6  8  4  9  7  6  7  8  5  1  8  2
##  [481]  7  7 10  1  5  6  5  5  8  9  9  1  4  1  6 10  5  9  6  7 10  6  5  4
##  [505]  7  8  8 10  4 10  6  8  8  7  9  4  8 10  8  5  4  5  8  7  7  9 10 10
##  [529]  9  8  8  8  2  7  5 10  8 10  8  6 10 10  7  6  5 10  2 10  9  3  9  6
##  [553]  9  3  1  6  8  7 10  6  9  2  2  5 10  7  7  4  8 10 10  2  9  8  8  4
##  [577]  7 10  8  9  8  7  8 10  5 10  8 10  9  9  7  3  7  7 10 10  7  5  8  9
##  [601]  7  3 10 10  2  9  4  9  6 10  2  6 10  7  6  5 10  5  5  4 10  4  7 10
##  [625]  5  8  8  1  5 10 10  5  4 10  9  8 10  4  5  8  8 10  7 10  3  8  9  9
##  [649]  6  5  9  5  6  3  9  4  8  6  4 10  9  3  7  4 10 10  7 10  8  1  8  7
##  [673] 10 10  7  7  6  4  5  9  6 10  5  1  6  6  9  6  2  9  4  8 10  5  5  7
##  [697]  6  6  7  9  9 10 10  7  9  7  3  8 10 10  7  6  7  6 10  7  3  7 10  4
##  [721] 10  7 10  8 10  4  4  9  9  7  2  5  8  1  9  8 10 10  8  8  8  7  7  8
##  [745]  9  9  3  3 10 10  2  8 10  5  1  7  2  6  9  4  7 10  8  3  9 10  3  8
##  [769] 10 10  8  7  9  9  6 10  7  6  7  3  1  2  8  6 10  6  6  4 10 10  9 10
##  [793]  9  8  5  8  7  9  5  6  6 10  8  7  9 10  8  8  8 10  8  4  3  9  6  3
##  [817]  4  9  6  6  7 10  5 10  5  4  4  3 10  6 10 10  6  9  8 10  8  3  3  6
##  [841]  6 10 10  6  1  9  7  6  5  5  4  6  4  6  8  8  9  9 10  8  8  7  5  2
##  [865]  9  7  9  8 10  9  2  9  9  3  9 10  5  7 10 10  4 10  6  5  3  5 10  9
##  [889]  5  4  8  2 10  9  4  9  7 10 10  7  2  5 10  9 10  9 10  1  8 10  6  9
##  [913]  2  6  8  5  5  9  2  1  9  8  9  7  6  5  8 10  7  4  9  7  6  8  8  4
##  [937]  4  3  9 10  8 10  9 10  4  2  4  5  5 10  4  3  4  7 10  3  2  8  4  9
##  [961]  5 10  9  6  5 10  4  8 10  5  7  7  7  8  9  9 10  2  4  6  6  2  8  3
##  [985]  8  1  9  4  8 10  7  6  8  7 10 10  9  6  5  7</code></pre>
</div>
<div id="exercises-3.2" class="section level2">
<h2><strong>Exercises 3.2</strong>：</h2>
<p><strong>Question：</strong><br />
The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},x\in\mathbb
R\)</span>.Use the inverse transform method to generate a random sample
of size 1000 from this distribution. Use one of the methods shown in
this chapter to compare the generated sample to the target
distribution.<br />
</p>
<p><strong>Answer：</strong><br />
1、推导过程：<br />
<span class="math display">\[f(x)=\frac{1}{2}e^{-|x|}\Rightarrow
f(x) \left\{
    \begin{aligned}
    &amp;\frac{1}{2}e^x &amp;x\le 0\cr
    &amp;\frac{1}{2}e^{-x} &amp;x&gt;0 \cr
    \end{aligned}
\right.\]</span> 则可得分布函数 <span class="math display">\[F(x)=\left\{
    \begin{aligned}
    &amp;\frac{1}{2}e^x &amp;x\le 0\cr
    &amp;1-\frac{1}{2}e^{-x} &amp;x&gt;0 \cr
    \end{aligned}
\right.\]</span> 解出逆函数为 <span class="math display">\[x=F_x^{-1}(u)=\left\{
    \begin{aligned}
    &amp;\ln 2u &amp;0&lt;u\le \frac{1}{2} \cr
    &amp;\ln\frac{1}{2-2u} &amp;\frac{1}{2}&lt; u&lt;1 \cr
    \end{aligned}
\right.\]</span> 2、代码:<br />
思路：生成<span class="math inline">\(U\)</span>~<span class="math inline">\(U(0,1)\)</span>；返回<span class="math inline">\(x=F_x^{-1}(u)\)</span></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(u <span class="sc">&lt;=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span> , <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u) ,<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>u))<span class="co">#逆函数</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fl">0.5</span><span class="sc">*</span>e<span class="sc">^-</span><span class="fu">abs</span>(x)),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))<span class="co">#绘画直方图</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x) ,<span class="fu">max</span>(x), .<span class="dv">01</span>)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(y <span class="sc">&lt;=</span> <span class="dv">0</span> , <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(y) ,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y))</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="fu">lines</span>(y, z)<span class="co">#绘制目标分布曲线</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercises-3.7" class="section level2">
<h2><strong>Exercises 3.7</strong>：</h2>
<p><strong>Question：</strong><br />
Write a function to generate a random sample of size n from the
Beta(a,b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<p><strong>Answer：</strong><br />
1、推导：<br />
已知Beta(a,b)的密度函数为 <span class="math display">\[f(x)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}\]</span>
令<span class="math inline">\(g(x)=1\)</span>,故 <span class="math display">\[\frac{f(x)}{g(x)}=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}
\le \frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\]</span> <span class="math display">\[\Rightarrow
c=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\]</span> <span class="math display">\[\Rightarrow
\frac{f(x)}{cg(x)}=x^{a-1}(1-x)^{b-1}\]</span> 2、代码:<br />
思路：生成随机数<span class="math inline">\(U\)</span><sub><span class="math inline">\(U(0,1)\)</span>和<span class="math inline">\(Y\)</span></sub><span class="math inline">\(g(·)\)</span>；如果<span class="math inline">\(U\le
\rho(Y)\)</span>,则接受Y并认为X=Y；否则拒绝Y并继续实验<br />
函数：<br />
</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>BETA <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b) {</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>j <span class="ot">&lt;-</span> k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#~g(.)</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  <span class="cf">if</span> (x<span class="sc">^</span>(a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x)<span class="sc">^</span>(b <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">&gt;</span> u) </span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    {</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>     k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>     y[k] <span class="ot">&lt;-</span> x    <span class="co">#接受x</span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>    }</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>  }</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="fu">print</span>(j) <span class="co">#可观察c的值</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>y</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>  }</span></code></pre></div>
<p>应用：<br />
</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">BETA</span>(<span class="dv">1000</span>, a, b)</span></code></pre></div>
<pre><code>## [1] 12025</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">hist</span>(y , <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>fz <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">*</span> z<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> z)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="co">#常数c=gama(5)/gama(3)gama(2)=12</span></span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a><span class="fu">lines</span>(z, fz)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercises-3.9" class="section level2">
<h2><strong>Exercises 3.9</strong>：</h2>
<p><strong>Question：</strong><br />
The rescaled Epanechnikov kernel [85] is a symmetric density
function<br />
<span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),   |x|\leq
1\]</span><br />
Devroye and Györfi [71, p. 236] give the following algorithm for
simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3\)</span> ~ Uniform(−1,1).If <span class="math inline">\(|U_3|\geq |U_2|\)</span> and <span class="math inline">\(|U_3|\geq |U_1|\)</span>,deliver <span class="math inline">\(U_2\)</span>；otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random
variates from <span class="math inline">\(f_e\)</span> , and construct
the histogram density estimate of a large simulated random sample.</p>
<p><strong>Answer：</strong><br />
1、函数：<br />
</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>Epan <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>u3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u2[i])) <span class="sc">&amp;&amp;</span> (<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span><span class="fu">abs</span>(u1[i])))</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> u2[i]</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  <span class="cf">else</span> x[i] <span class="ot">&lt;-</span> u3[i]</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>  }</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  x</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>}</span></code></pre></div>
<p>2、应用：<br />
</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">Epan</span>(<span class="dv">1000</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">hist</span>(z, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="fu">lines</span>(z, <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> z<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercises-3.10" class="section level2">
<h2><strong>Exercises 3.10</strong>：</h2>
<p><strong>Question：</strong><br />
Prove that the algorithm given in Exercise 3.9 generates variates from
the density <span class="math inline">\(f_e\)</span> (3.10).<br />
</p>
<p><strong>Answer：</strong><br />
由题可知，当<span class="math inline">\(|U_3|\geq |U_2|\)</span> and
<span class="math inline">\(|U_3|\geq |U_1|\)</span>,取<span class="math inline">\(Y=U_2\)</span>，否则<span class="math inline">\(Y=U_3\)</span><br />
则令<span class="math inline">\(Y_1、Y_2、Y_3\)</span>~<span class="math inline">\(U(0,1)\)</span><br />
因此，<span class="math inline">\(Y\)</span>取<span class="math inline">\(Y_1、Y_2、Y_3\)</span>中次序为1或2的顺序统计量(不取最大值），且取得概率分别为1/2,1/2<br />
首先令<span class="math inline">\(X=\pm Y\)</span><br />
已知样本容量为<span class="math inline">\(n\)</span>的第<span class="math inline">\(k\)</span>个顺序统计量的分布函数为： <span class="math display">\[F_k(y)=\sum_{j=k}^{n}\binom{n}{j}[F(y)]^j[1-F(y)]^{n-j}\]</span>
因此，当<span class="math inline">\(n\)</span>=3时，<span class="math inline">\(Y\)</span>的分布函数为： <span class="math display">\[\begin{equation}
\begin{aligned}
F(y)&amp;=\frac{1}{2}F_1(y)+\frac{1}{2}F_2(y) \\
&amp;=\sum_{j=k}^{n}\binom{n}{j}[F(y)]^j[1-F(y)]^{n-j}\\
&amp;=\frac{1}{2}[(1-(1-y)^3)]+(3y^2(1-y)+y^3)\\
&amp;=\frac{1}{2}[3y-y^3]
\end{aligned}
\end{equation}\]</span> 对<span class="math inline">\(F(y)\)</span>求导可得<span class="math inline">\(Y\)</span>的概率密度函数为<br />
<span class="math display">\[f_Y(y)=F&#39;(y)=\frac{3}{2}(1-y^2),y\in(0,1)\]</span>
又<span class="math inline">\(X=\pm Y\in (-1,1)\)</span>，<span class="math inline">\(X\)</span>的密度函数为 <span class="math display">\[f_X(x)=\frac{1}{2}\times\frac{3}{2}(1-x^2)=\frac{3}{4}(1-x^2),z\in
(-1,1)\]</span>#<br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw2" class="section level1">
<h1><strong>HW2</strong></h1>
<div id="exercise-1" class="section level2">
<h2><strong>Exercise 1</strong></h2>
<p><strong>Question</strong><br />
Proof that what value <span class="math inline">\(ρ=\frac{l}{d}\)</span>should take to minimize the
asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span>?
<span class="math inline">\((m\sim B(n,p)\)</span>,using δ method)<br />
Take three different values of <span class="math inline">\(ρ (0 ≤ ρ ≤
1\)</span>, including <span class="math inline">\(ρ_{min}\)</span>) and
use Monte Carlo simulation to verify your answer. (n = <span class="math inline">\(10^6\)</span> , Number of repeated simulations K =
100)</p>
<p><strong>Answer</strong><br />
1.Proof<br />
设每两条平行线距离为<span class="math inline">\(l\)</span>，针长度为<span class="math inline">\(d\)</span>，投针试验次数为<span class="math inline">\(n\)</span>，针与直线相交次数为<span class="math inline">\(m\)</span>，则<span class="math inline">\(m\sim
B(n,p)\)</span>，其中<span class="math inline">\(p\)</span>为针与线相交的概率，则<span class="math inline">\(\hat{p}=\frac{m}{n}\)</span><br />
由中心极限定理，可得: <span class="math display">\[\sqrt{n}(\hat{p}-p)
\stackrel{d}{\rightarrow} N(0,p(1-p))\]</span> 令<span class="math inline">\(\rho=\frac{l}{d}\)</span>，则估计量<span class="math inline">\(\hat{\pi}=\frac{2l}{d\hat{p}}=\frac{2\rho}{\hat{p}}，(\rho=\pi
p/2)\)</span><br />
由Delta法可知，若<span class="math inline">\(g(X_n)\)</span>在<span class="math inline">\(\theta\)</span>处连续可导，<span class="math inline">\(\sqrt{n}(X_n-\theta) \stackrel{d}{\rightarrow}
N(0,\sigma^2),则\sqrt{n}(f(X_n)-f(\theta)) \stackrel{d}{\rightarrow}
N(0,\sigma^2[f&#39;(\theta)]^2)\)</span>,<br />
则有<span class="math inline">\(\pi=f(\theta)=f(p)=\frac{2\rho}{p}，[f&#39;(p)]^2=\frac{4\rho^2}{p^4}\)</span>,<br />
代入可得,<span class="math inline">\(\hat{\pi}\)</span>的渐进方差为：
<span class="math display">\[AsymptoticVariance(\hat{\pi})=\sigma^2[f&#39;(\theta)]^2=\frac{4\rho^2(1-p)}{p^3}=\frac{4(\pi
p/2)^2(1-p)}{p^3}=\frac{\pi^2(1-p)}{p}\]</span><br />
由于<span class="math inline">\(0≤p≤1\)</span>，<span class="math inline">\(0≤\rho≤1\)</span>，且<span class="math inline">\(\rho=\pi p/2\)</span>,<span class="math inline">\(AsymptoticVariance(\hat{\pi})\)</span>随<span class="math inline">\(p\)</span>单调递减,则<span class="math inline">\(\rho_{min}=1\)</span>时该渐进方差最小.</p>
<p>2.code Verify<br />
</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span><span class="co">#重复次数</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>l1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>l2 <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>l3 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>Vpihat1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>Vpihat2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>Vpihat3 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(l1<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(l2<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(l3<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>Vpihat1 <span class="ot">&lt;-</span> Vpihat1<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>(l1<span class="sc">/</span>d)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">/</span>p1<span class="sc">^</span><span class="dv">3</span><span class="co">#计算渐进方差，rou=1</span></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>Vpihat2 <span class="ot">&lt;-</span> Vpihat2<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>(l2<span class="sc">/</span>d)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p2)<span class="sc">/</span>p2<span class="sc">^</span><span class="dv">3</span><span class="co">#rou=0.8</span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>Vpihat3 <span class="ot">&lt;-</span> Vpihat3<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>(l3<span class="sc">/</span>d)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p3)<span class="sc">/</span>p3<span class="sc">^</span><span class="dv">3</span><span class="co">#rou=0.5</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>}</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>Vpihat1<span class="sc">/</span>k;Vpihat2<span class="sc">/</span>k;Vpihat3<span class="sc">/</span>k<span class="co">#比较渐进方差</span></span></code></pre></div>
<pre><code>## [1] 5.634976</code></pre>
<pre><code>## [1] 9.510351</code></pre>
<pre><code>## [1] 21.15064</code></pre>
<p>由此可知，当<span class="math inline">\(\rho_{min}=1\)</span>时该渐进方差最小</p>
</div>
<div id="exercise-5.6" class="section level2">
<h2><strong>Exercise 5.6</strong></h2>
<p><strong>Question:</strong><br />
In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[\theta=\int^{1}_{0}e^xdx\]</span> Now consider
the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>,where <span class="math inline">\(U\sim Uniform(0,1)\)</span>. What is the percent
reduction in variance of <span class="math inline">\(\hat{θ}\)</span>
that can be achieved using antithetic variates (compared with simple
MC)?<br />
<strong>Answer:</strong><br />
计算 <span class="math inline">\(Cov(e^U,e^1-U)\)</span> 和 <span class="math inline">\(Var(e^U+e^{1-U})\)</span><br />
<span class="math display">\[\begin{equation}
\begin{aligned}
Cov(e^U,e^{1-U})&amp;=E[e^Ue^{1-U}]-E[e^U]E[e^{1-U}]\\
&amp;=e-\int^{1}_{0}e^udu\int^{1}_{0}e^{1-u}du\\
&amp;=e-(e-1)^2
\end{aligned}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
Var(e^U+e^{1-U})&amp;=Var(e^U)+Var(e^{1-U})+2Cov(e^U,e^{1-U})\\
&amp;=2Var(e^U)+2Cov(e^U,e^{1-U})\\
&amp;=2[E(e^{2U})-(E(e^{U}))^2]+2Cov(e^U,e^{1-U})\\
&amp;=2[\frac{1}{2}(e^2-1)-(e-1)^2]+2[e-(e-1)^2]\\
&amp;=(e^2-1)+2e-4(e-1)^2
\end{aligned}
\end{equation}\]</span></p>
<p>假设<span class="math inline">\(\hat{\theta_1}、\hat{\theta_2}\)</span>分别是的MC和对偶变量法的估计量，<br />
对于Simple MC，设<span class="math inline">\(U_1\)</span>、<span class="math inline">\(U_2\sim U(0,1)\)</span>且相互独立：<br />
<span class="math display">\[Var(\hat{\theta_1})=Var(\frac{1}{2}(e^{U_1}+e^{U_2}))=\frac{1}{2}Var(e^U)=\frac{1}{4}(e^2-1)-\frac{1}{2}(e-1)^2\]</span><br />
对于对偶变量法：<br />
<span class="math display">\[Var(\hat{\theta_2})=Var(\frac{1}{2}(e^U+e^{1-U}))=\frac{1}{4}Var(e^U+e^{1-U})=\frac{1}{4}(e^2-1)+\frac{1}{2}e-(e-1)^2\]</span>
则方差降低比率为： <span class="math display">\[\frac{Var(\hat{\theta_1})-Var(\hat{\theta_2})}{Var(\hat{\theta_1})}=\frac{\frac{1}{4}(e^2-1)-\frac{1}{2}(e-1)^2-[\frac{1}{4}(e^2-1)+\frac{1}{2}e-(e-1)^2]}{\frac{1}{4}(e^2-1)+\frac{1}{2}e-(e-1)^2}\approx0.96767
\]</span> 即方差降低了96.77%</p>
</div>
<div id="exercise-5.7" class="section level2">
<h2><strong>Exercise 5.7</strong></h2>
<p><strong>Question</strong><br />
Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by the
antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>anti <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>i<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a><span class="cf">while</span> (i <span class="sc">&lt;=</span> n ){</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>  U1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>  U2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>U1</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>  mc[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">exp</span>(U))<span class="co">#simple monte carlo </span></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>  anti[i]<span class="ot">&lt;-</span><span class="fu">mean</span>((<span class="fu">exp</span>(U1)<span class="sc">+</span><span class="fu">exp</span>(U2))<span class="sc">/</span><span class="dv">2</span>)<span class="co">#antithetic variate</span></span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>  i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>}</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>V1 <span class="ot">&lt;-</span> <span class="fu">var</span>(mc)</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>V2 <span class="ot">&lt;-</span> <span class="fu">var</span>(anti)</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>redu <span class="ot">&lt;-</span> (V1<span class="sc">-</span>V2)<span class="sc">/</span>V1</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a><span class="fu">print</span>(redu)</span></code></pre></div>
<pre><code>## [1] 0.9676507</code></pre>
<p>这一结果与Exercise 5.6中的结果96.77%十分接近。<br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw3" class="section level1">
<h1><strong>HW3</strong></h1>
<div id="exercise-1-1" class="section level2">
<h2><strong>Exercise 1</strong></h2>
<p><strong>Question</strong><br />
Proof that if <span class="math inline">\(g\)</span> is a continuous
function over (a,b), then <span class="math inline">\(Var(\hat{\theta^S})/Var(\hat{\theta^M})\rightarrow0\quad
as\quad b_i-a_i\rightarrow0\)</span> for all <span class="math inline">\(i=1,...,k.\)</span></p>
<p><strong>Answer</strong><br />
设分层估计量<span class="math inline">\(\hat{\theta^S}\)</span>和简单估计量<span class="math inline">\(\hat{\theta^M}\)</span>为： <span class="math display">\[\hat{\theta^S}=\frac{1}{km}\sum_{i=1}^k\sum_{j=1}^mg(U_{ji}),U_{ji}\sim(a_i,b_i)\]</span>
<span class="math display">\[\hat{\theta^M}=\frac{1}{M}\sum_{i=1}^Mg(U_{i}),U_{i}\sim(a,b)\]</span>
其中，样本量<span class="math inline">\(M=mk\)</span>, <span class="math inline">\(k\)</span>为层数，每层样本量<span class="math inline">\(m_1=...=m_k=m\)</span>不失一般性.<br />
则两估计量方差分别为： <span class="math display">\[Var(\hat{\theta^S})=Var(\frac{1}{k}\sum_{i=1}^k\hat{\theta_i})=\frac{1}{Mk}\sum_{i=1}^k\sigma_i^2,\quad\sigma_i^2=Var(g(U_{ji}))\]</span>
<span class="math display">\[\begin{equation}
\begin{aligned}
Var(\hat{\theta^M})&amp;=\frac{1}{M}Var(g(U))\\
&amp;=\frac{1}{M}\left \{ E[Var(g(U)|I)]+Var[E(g(U)|I)] \right \}\\
&amp;=\frac{1}{M}\left \{ E\sigma^2_I+Var(\theta_I) \right \}\\
&amp;=Var(\hat{\theta^S})+\frac{1}{M}Var(\theta_I)
\end{aligned}
\end{equation}\]</span> 若样本量m为常数，当<span class="math inline">\(b_i-a_i\rightarrow0\)</span>时，即<span class="math inline">\(m\rightarrow0\)</span>，则<span class="math inline">\(k\rightarrow \infty\)</span>.当<span class="math inline">\(g\)</span>在区间(a,b)上处处连续，则<span class="math inline">\(Var(\hat{\theta^S})=\frac{1}{Mk}\sum_{i=1}^k\sigma_i^2\rightarrow0,Var(\hat{\theta^S})\rightarrow\frac{1}{M}Var(\theta_I)\)</span>，因此<span class="math inline">\(Var(\hat{\theta^S})/Var(\hat{\theta^M})\rightarrow0,i=1,...,k.\)</span></p>
</div>
<div id="exercise-5.13" class="section level2">
<h2><strong>Exercise 5.13</strong></h2>
<p><strong>Question</strong><br />
Find two importance functions <span class="math inline">\(f_1\)</span>
and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad
x&gt;1.\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int^\infty_1\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>
by importance sampling? Explain.</p>
<p><strong>Answer</strong><br />
分别选取正态分布<span class="math inline">\(N(0,1)\)</span>和伽马分布<span class="math inline">\(Ga(1.5,1)\)</span>，为使选取函数支撑集为<span class="math inline">\((1,\infty)\)</span>，对两分布概率密度函数进行变换：<br />
<span class="math display">\[f_1(x)=2f(x-1),x\sim N(0,1)\]</span> <span class="math display">\[f_2(y)=g(y-1),y\sim Ga(1.5,1)\]</span> 其中<span class="math inline">\(f(·)、g(·)\)</span>分别为对应的概率密度函数<br />
经变换后满足上述支撑集条件，分别在图中绘制<span class="math inline">\(g(x)\)</span>、重要性函数<span class="math inline">\(f_1\)</span>和<span class="math inline">\(f_2\)</span>图像.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>,<span class="fl">0.01</span>)</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x<span class="dv">-1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(x<span class="dv">-1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>)</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="fu">plot</span>(x, g, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">12</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a><span class="fu">lines</span>(x, f1, <span class="at">col=</span><span class="dv">54</span>)</span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="fu">lines</span>(x, f2, <span class="at">col=</span><span class="dv">61</span>)</span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">54</span>,<span class="dv">61</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /><br />
分别绘制<span class="math inline">\(\frac{g}{f_1}、\frac{g}{f_2}\)</span>图像.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">plot</span>(x, g<span class="sc">/</span>f1, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">12</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">lines</span>(x, g<span class="sc">/</span>f2,<span class="at">col=</span><span class="dv">54</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g/f1&quot;</span>,<span class="st">&quot;g/f2&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">54</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>V1 <span class="ot">&lt;-</span> <span class="fu">var</span>(g<span class="sc">/</span>f1);V2 <span class="ot">&lt;-</span> <span class="fu">var</span>(g<span class="sc">/</span>f2)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">c</span>(V1,V2)<span class="co">#g/f1、g/f2的方差</span></span></code></pre></div>
<pre><code>## [1] 0.02545814        NaN</code></pre>
<p>由图可知，比率<span class="math inline">\(\frac{g}{f_1}\)</span>相较于<span class="math inline">\(\frac{g}{f_2}\)</span>更接近常数，故认为重要性函数<span class="math inline">\(f_1\)</span>在估计时方差更小，即<span class="math inline">\(f_1(x)=2f(x-1),x\sim N(0,1)\)</span></p>
</div>
<div id="exercise-5.14" class="section level2">
<h2><strong>Exercise 5.14</strong></h2>
<p><strong>Question</strong><br />
Obtain a Monte Carlo estimate of <span class="math display">\[\int^\infty_1\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>
by importance sampling.</p>
<p><strong>Answer</strong><br />
<span class="math inline">\(\theta=\int^\infty_1\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\)</span>可由下式估计
<span class="math display">\[\hat{\theta}=\frac{1}{m}\sum_{i=1}^{m}\frac{g(X_i)}{f(X_i)}\]</span><br />
其中<span class="math inline">\(X\)</span>概率密度函数为<span class="math inline">\(f(·).\)</span></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">rchisq</span>(m, <span class="dv">1</span>)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x<span class="dv">-1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>theta1[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g<span class="sc">/</span>f1)</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m, <span class="fl">1.5</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">dgamma</span>(x<span class="dv">-1</span>, <span class="fl">1.5</span>, <span class="dv">1</span>)</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>theta2[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g<span class="sc">/</span>f2)</span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>}</span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta1);M2 <span class="ot">&lt;-</span><span class="fu">mean</span>(theta2)</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a><span class="fu">c</span>(M1,M2)<span class="co">#基于f1和f2的估计值</span></span></code></pre></div>
<pre><code>## [1] 0.4006239 0.4005369</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>V1 <span class="ot">&lt;-</span> <span class="fu">var</span>(theta1);V2 <span class="ot">&lt;-</span> <span class="fu">var</span>(theta2)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="fu">c</span>(V1,V2)<span class="co">#基于f1和f2的估计量方差</span></span></code></pre></div>
<pre><code>## [1] 1.991100e-07 7.069862e-06</code></pre>
<p>由结果可知，基于重要性函数<span class="math inline">\(f_1\)</span>和<span class="math inline">\(f_2\)</span>的估计值十分相近，然而<span class="math inline">\(f_1\)</span>估计值方差小于<span class="math inline">\(f_2\)</span>，这一结果与Exercise
5.13结果一致。</p>
</div>
<div id="exercise-5.15" class="section level2">
<h2><strong>Exercise 5.15</strong></h2>
<p><strong>Question</strong><br />
Obtain the stratified importance sampling estimate in Example 5.13 and
compare it with the result of Example 5.10.</p>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span> </span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="dv">1</span> ; k2 <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co">#使用分层抽样</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> m<span class="sc">/</span>k2</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">1</span> ; j<span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>V2 <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a><span class="co">#Example 5.10：不使用分层抽样法</span></span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, <span class="dv">0</span>, <span class="dv">1</span>) </span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u1)</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> (k1<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(g<span class="sc">/</span>f1)</span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(g<span class="sc">/</span>f1)</span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a><span class="co">#使用分层抽样法</span></span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k2){</span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a>  u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">/</span>k2, (j<span class="dv">-1</span>)<span class="sc">/</span>k2, j<span class="sc">/</span>k2)</span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u2)</span>
<span id="cb48-20"><a href="#cb48-20" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb48-21"><a href="#cb48-21" tabindex="-1"></a>  f2 <span class="ot">&lt;-</span> (k2<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb48-22"><a href="#cb48-22" tabindex="-1"></a>  T2[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(g<span class="sc">/</span>f2)</span>
<span id="cb48-23"><a href="#cb48-23" tabindex="-1"></a>  V2[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(g<span class="sc">/</span>f2)</span>
<span id="cb48-24"><a href="#cb48-24" tabindex="-1"></a>  } </span>
<span id="cb48-25"><a href="#cb48-25" tabindex="-1"></a>est2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(T2)</span>
<span id="cb48-26"><a href="#cb48-26" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(V2))</span>
<span id="cb48-27"><a href="#cb48-27" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" tabindex="-1"></a><span class="co">#结果展示</span></span>
<span id="cb48-29"><a href="#cb48-29" tabindex="-1"></a><span class="fu">c</span>(est1,est2)<span class="co">#无分层 vs 有分层 估计值结果</span></span></code></pre></div>
<pre><code>## [1] 0.5253695 0.5249711</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">c</span>(s1,s2)<span class="co">#无分层 vs 有分层 估计量标准差</span></span></code></pre></div>
<pre><code>## [1] 0.096566290 0.004183757</code></pre>
<p>由结果可知，与Example 5.10中的无分层重要性抽样估计方法相比，Exercise
5.13中有分层重要性抽样方法在估计时方差更小。</p>
</div>
<div id="exercise-6.5" class="section level2">
<h2><strong>Exercise 6.5</strong></h2>
<p><strong>Question</strong><br />
Suppose a 95% symmetric t-interval is applied to estimate a mean, but
the sample data are non-normal. Then the probability that the confidence
interval covers the mean is not necessarily equal to 0.95. Use a Monte
Carlo experiment to estimate the coverage probability of the t-interval
for random samples of <span class="math inline">\(\chi^2(2)\)</span>
data with sample size <span class="math inline">\(n=20\)</span>. Compare
your t-interval results with the simulation results in Example 6.4. (The
<span class="math inline">\(t\)</span>-interval should be more robust to
departures from normality than the interval for variance.)</p>
<p><strong>Answer</strong><br />
已知t区间为<span class="math inline">\([\bar{x}-t_{\frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}},\bar{x}+t_{\frac{\alpha}{2}}\frac{\sigma}{\sqrt{n}}]\)</span>，产生样本量<span class="math inline">\(n=20\)</span>的随机变量<span class="math inline">\(X\sim \chi^2(2)\)</span>，其均值为<span class="math inline">\(E(X)=2\)</span></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co">#t-interval</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e5</span> <span class="co">#repeat times</span></span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span> </span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>tL <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.025</span>, <span class="at">df=</span>n<span class="dv">-1</span>) ; tU <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>LCL <span class="ot">&lt;-</span> UCL <span class="ot">&lt;-</span> <span class="fu">vector</span>() </span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>  LCL[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span>tL<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>  UCL[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)<span class="sc">+</span>tU<span class="sc">*</span><span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>}</span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a><span class="fu">mean</span>(LCL<span class="sc">&lt;</span><span class="dv">2</span> <span class="sc">&amp;</span> UCL<span class="sc">&gt;</span><span class="dv">2</span>) <span class="co">#t-interval CP</span></span></code></pre></div>
<pre><code>## [1] 0.91924</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co">#Example 6.4</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>(n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>} )</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a><span class="fu">mean</span>(UCL <span class="sc">&gt;</span> <span class="dv">4</span>) <span class="co">#CP of interval for variance</span></span></code></pre></div>
<pre><code>## [1] 0.783</code></pre>
<p>由结果可知，t区间的CP为91.94%，而方差区间的CP仅为77.3%，因此t区间比方差区间对偏离正态性更具鲁棒性。</p>
</div>
<div id="exercise-6.a" class="section level2">
<h2><strong>Exercise 6.A</strong></h2>
<p><strong>Question</strong><br />
Use Monte Carlo simulation to investigate whether the empirical Type I
error rate of the t-test is approximately equal to the nominal
significance level <span class="math inline">\(\alpha\)</span>, when the
sampled population is non-normal. The <span class="math inline">\(t\)</span>-test is robust to mild departures from
normality. Discuss the simulation results for the cases where the
sampled population is (i)<span class="math inline">\(\chi^2(1)\)</span>,
(ii) Uniform(0,2), and (iii) Exponential (rate=1). In each case, test
<span class="math inline">\(H_0:\mu=\mu_0\)</span> VS <span class="math inline">\(H_1:\mu\ne\mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and
Exponential(1), respectively.</p>
<p><strong>Answer</strong><br />
已知(i)<span class="math inline">\(\mu_0=1,x\sim\chi^2(1)\)</span>;
(ii)<span class="math inline">\(\mu_0=1,x\sim\)</span>Uniform(0,2);
(iii)<span class="math inline">\(\mu_0=1,x\sim\)</span>Exponential(1)，且t-检验：<span class="math inline">\(\frac{\bar{x}-\mu}{\sigma/\sqrt{n}}\sim
t(n-1)\)</span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e5</span> <span class="co">#repeat times</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span> <span class="co">#sample size</span></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span> <span class="co">#nominal significance level</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>x<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,n)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,m)</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  x[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>  x[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  x[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n,<span class="at">rate=</span><span class="dv">1</span>)</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>    pval[j,i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>( (<span class="fu">mean</span>(x[j,])<span class="sc">-</span><span class="dv">1</span>) <span class="sc">/</span> (<span class="fu">sd</span>(x[j,]<span class="sc">/</span> <span class="fu">sqrt</span>(n) ) )),n<span class="dv">-1</span>) )</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  }</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>}</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(pval[<span class="dv">1</span>,]<span class="sc">&lt;=</span>alpha),<span class="fu">mean</span>(pval[<span class="dv">2</span>,]<span class="sc">&lt;=</span>alpha),<span class="fu">mean</span>(pval[<span class="dv">3</span>,]<span class="sc">&lt;=</span>alpha))</span></code></pre></div>
<pre><code>## [1] 0.05125 0.05043 0.05121</code></pre>
<p>由结果可知，当样本分别服从<span class="math inline">\(\chi^2(1)\)</span>、Uniform(0,2)、Exponential(rate=1)分布时，t检验的经验第一类错误率分别为0.05125、0.05043、0.05121，与显著性水平<span class="math inline">\(\alpha=0.05\)</span>相近，且偏离正态样本下均匀分布样本下t检验结果最为稳健，其次是指数分布、最后是卡方分布。<br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw4" class="section level1">
<h1><strong>HW4</strong></h1>
<div id="exercise-1-2" class="section level2">
<h2><strong>Exercise 1</strong></h2>
<p><strong>Question</strong><br />
考虑
m=1000个假设，其中前95%个原假设成立，后5%个对立假设成立。在原假设之下，p值服从U（0,1）分布，在对立假设之下，p值服从Beta（0.1,1）分布（可用rbeta生成），应用Bonferroni矫正与B-H矫正应用于生成的m个P值（独立）（应用P.adjust），得到校正后的P值，与<span class="math inline">\(\alpha=0.1\)</span>比较确定是否拒绝原假设.基于
M=1000次模拟，可估计FWER，FDR，TPR.</p>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#repeat times</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>FWER <span class="ot">&lt;-</span> FDR <span class="ot">&lt;-</span> TPR <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span>M)</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="fu">set.seed</span>(i)</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m<span class="sc">*</span><span class="fl">0.95</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co">#原假设</span></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(m<span class="sc">*</span><span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="dv">1</span>) <span class="co">#对立假设</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(p1,p2)<span class="co">#合并</span></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>p.adj1 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;bonferroni&#39;</span>)<span class="co">#bonferroni</span></span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a>p.adj2 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;BH&#39;</span>) <span class="co">#B-H   </span></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a><span class="co">#FWER：原假设为真情况下，故仅使用前950个原假设</span></span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>FWER[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( <span class="fu">sum</span>(p.adj1[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span> ,<span class="dv">1</span>,<span class="dv">0</span>)<span class="co">#bonferroni</span></span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>FWER[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>( <span class="fu">sum</span>(p.adj2[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span> ,<span class="dv">1</span>,<span class="dv">0</span>)<span class="co">#B-H</span></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a><span class="co">#FDR</span></span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a>FDR[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj1[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p.adj1<span class="sc">&lt;</span>alpha)</span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>FDR[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj2[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p.adj2<span class="sc">&lt;</span>alpha)</span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a><span class="co">#TPR</span></span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a>TPR[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj1[<span class="dv">950</span><span class="sc">:</span>m]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb58-25"><a href="#cb58-25" tabindex="-1"></a>TPR[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj2[<span class="dv">950</span><span class="sc">:</span>m]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb58-26"><a href="#cb58-26" tabindex="-1"></a>}</span>
<span id="cb58-27"><a href="#cb58-27" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(FWER[<span class="dv">1</span>,]),<span class="fu">mean</span>(FWER[<span class="dv">2</span>,]))<span class="co">#FWER</span></span>
<span id="cb58-28"><a href="#cb58-28" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(FDR[<span class="dv">1</span>,]),<span class="fu">mean</span>(FDR[<span class="dv">2</span>,]))<span class="co">#FDR</span></span>
<span id="cb58-29"><a href="#cb58-29" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(TPR[<span class="dv">1</span>,]),<span class="fu">mean</span>(TPR[<span class="dv">2</span>,]))<span class="co">#TPR</span></span></code></pre></div>
<pre><code>## [1] 0.083 0.932
## [1] 0.004251612 0.095346095
## [1] 0.39790 0.56516</code></pre>
<p>输出结果为:</p>
<table>
<thead>
<tr class="header">
<th align="center">矫正方法</th>
<th align="center">FWER</th>
<th align="center">FDR</th>
<th align="center">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">bonferroni</td>
<td align="center">0.083</td>
<td align="center">0.004</td>
<td align="center">0.398</td>
</tr>
<tr class="even">
<td align="center">B-H</td>
<td align="center">0.932</td>
<td align="center">0.095</td>
<td align="center">0.565</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-2" class="section level2">
<h2><strong>Exercise 2</strong></h2>
<p><strong>Question</strong><br />
Conduct a simulation study to verify the performance of the bootstrap
method.</p>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>lamda <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#true value </span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#replicates</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#repeat times</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>) <span class="co">#sample size</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a><span class="co">#theoretical</span></span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>the_bia <span class="ot">&lt;-</span> lamda<span class="sc">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>the_sd <span class="ot">&lt;-</span> lamda<span class="sc">*</span>n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a><span class="co">#bootstrap</span></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>thetastar <span class="ot">&lt;-</span> <span class="fu">vector</span>()</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>boo_bia <span class="ot">&lt;-</span> boo_sd <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span>m)</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m ){</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>    <span class="fu">set.seed</span>(i<span class="sc">+</span>j)</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n[j],lamda)</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>    <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a>    xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">replace =</span> <span class="cn">TRUE</span> )</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a>    thetastar[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)     </span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>    }</span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a>    boo_bia[j,i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(thetastar)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a>    boo_sd[j,i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(thetastar)</span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a>  }</span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a>}</span>
<span id="cb60-26"><a href="#cb60-26" tabindex="-1"></a>the_bia <span class="co">#theoretical</span></span>
<span id="cb60-27"><a href="#cb60-27" tabindex="-1"></a><span class="fu">apply</span>(boo_bia,<span class="at">MARGIN =</span> <span class="dv">1</span>,mean)<span class="co"># bootstrap</span></span>
<span id="cb60-28"><a href="#cb60-28" tabindex="-1"></a>the_sd <span class="co">#theoretical</span></span>
<span id="cb60-29"><a href="#cb60-29" tabindex="-1"></a><span class="fu">apply</span>(boo_sd,<span class="at">MARGIN =</span> <span class="dv">1</span>,mean) <span class="co">#bootstrap</span></span></code></pre></div>
<pre><code>## [1] 0.5000000 0.2222222 0.1052632
## [1] 0.54699752 0.20962037 0.09711249
## [1] 1.4433757 0.7856742 0.4962153
## [1] 2.0490404 0.7958524 0.4823857</code></pre>
<p>输出结果为:</p>
<table>
<colgroup>
<col width="24%" />
<col width="19%" />
<col width="17%" />
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">变量</th>
<th align="center">Bias(Theoretical)</th>
<th align="center">Bias(Bootstrap)</th>
<th align="center">SD(Theoretical))</th>
<th align="center">SD(Bootstrap)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">n=5</td>
<td align="center">0.500</td>
<td align="center">0.547</td>
<td align="center">1.443</td>
<td align="center">2.049</td>
</tr>
<tr class="even">
<td align="center">n=10</td>
<td align="center">0.222</td>
<td align="center">0.210</td>
<td align="center">0.786</td>
<td align="center">0.796</td>
</tr>
<tr class="odd">
<td align="center">n=20</td>
<td align="center">0.105</td>
<td align="center">0.097</td>
<td align="center">0.496</td>
<td align="center">0.482</td>
</tr>
</tbody>
</table>
<p>比较上表Bootstrap和理论结果可知，随着样本数量n增大时，Bootstrap结果越来越接近理论值。</p>
</div>
<div id="exercise-7.3" class="section level2">
<h2><strong>Exercise 7.3</strong></h2>
<p><strong>Question</strong><br />
Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (law data in bootstrap).</p>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>B1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>)   <span class="co">#replicates numbers</span></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span>                    <span class="co">#repeat times for generating se_hat</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(law)              <span class="co">#sample size</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)  </span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a><span class="cf">for</span> (q <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  B <span class="ot">&lt;-</span> B1[q]  <span class="co">#令replicates numbers取值不同</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>  R <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)  </span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>  <span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>    <span class="fu">set.seed</span>(b)</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>) <span class="co">#抽序号</span></span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>    LSAT <span class="ot">&lt;-</span> law<span class="sc">$</span>LSAT[i]    <span class="co">#一列向量</span></span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>    GPA <span class="ot">&lt;-</span> law<span class="sc">$</span>GPA[i]</span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>    R[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(LSAT, GPA)</span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a>      <span class="fu">set.seed</span>(b<span class="sc">+</span>j)</span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a>      l <span class="ot">&lt;-</span> <span class="fu">sample</span>(i,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a>      S[j] <span class="ot">&lt;-</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT[l],law<span class="sc">$</span>GPA[l]) </span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a>    }</span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a>    se[b] <span class="ot">&lt;-</span> <span class="fu">sd</span>(S)        <span class="co">#Se^(theta^(b))</span></span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a>  }</span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">mean</span>(R)</span>
<span id="cb62-25"><a href="#cb62-25" tabindex="-1"></a>  SD <span class="ot">&lt;-</span> <span class="fu">sd</span>(R)             <span class="co">#Se^(theta^)</span></span>
<span id="cb62-26"><a href="#cb62-26" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">sort</span>((R<span class="sc">-</span>theta)<span class="sc">/</span>se) <span class="co">#t^*_a</span></span>
<span id="cb62-27"><a href="#cb62-27" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(theta<span class="sc">-</span>t[<span class="fu">length</span>(t)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)]<span class="sc">*</span>SD,theta<span class="sc">-</span>t[<span class="fu">length</span>(t)<span class="sc">*</span>alpha<span class="sc">/</span><span class="dv">2</span>]<span class="sc">*</span>SD)) </span>
<span id="cb62-28"><a href="#cb62-28" tabindex="-1"></a>  <span class="co">#B=100,200,500,1000下置信区间</span></span>
<span id="cb62-29"><a href="#cb62-29" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] -0.3940957  0.9795612
## [1] -0.2898947  0.9725709
## [1] -0.4175777  0.9894918
## [1] -0.2137023  0.9589813</code></pre>
<p>根据输出结果可知，相关系数的Bootstrap-t置信区间估计结果并不稳健（<span class="math inline">\(\alpha=0.05\)</span>）。若Bootstrap重复次数分别取B=100,200,500,1000时，其置信区间估计结果有显著差异；在生成<span class="math inline">\(t^*_a\)</span>时重抽样次数k取不同值也会产生显著差异。<br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw5" class="section level1">
<h1><strong>HW5</strong></h1>
<div id="exercise-7.5" class="section level2">
<h2><strong>Exercise 7.5</strong></h2>
<p><strong>Question</strong><br />
Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>lamda <span class="ot">&lt;-</span> <span class="cf">function</span>(y,i) <span class="fu">mean</span>(y[i])</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>lamda, <span class="at">R =</span> <span class="fl">5e3</span>)</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>de  <span class="co">#lambda</span></span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = lamda, R = 5000)
## 
## 
## Bootstrap Statistics :
##     original   bias    std. error
## t1* 108.0833 -1.28495     37.0825</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>ci.basic<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>ci.perc<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>ci.bca<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(ci.norm, ci.basic, ci.perc, ci.bca)   </span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>CI              <span class="co">#bootstrap confidence intervals</span></span></code></pre></div>
<pre><code>##        ci.norm ci.basic   ci.perc    ci.bca
## [1,]  36.68791  29.0896  46.83333  57.75393
## [2,] 182.04866 169.3333 187.07706 225.57872</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>CI[<span class="dv">2</span>,]<span class="sc">-</span>CI[<span class="dv">1</span>,]   <span class="co">#length of ci</span></span></code></pre></div>
<pre><code>##  ci.norm ci.basic  ci.perc   ci.bca 
## 145.3607 140.2437 140.2437 167.8248</code></pre>
<p>由结果可知：normal, basic, percentile 和 BCa
方法得到的置信区间各不相同，其中由于重复次数较少、分布存在一定偏度，percentile区间并不近似于normal区间（不对称）；
同时，normal, basic,
percentile置信区间长度相近，Bca置信区间经过偏差和偏度调整后长度最长.</p>
</div>
<div id="exercise-7.8" class="section level2">
<h2><strong>Exercise 7.8</strong></h2>
<p><strong>Question</strong><br />
Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Answer</strong><br />
由exercise7.7，<span class="math inline">\(\hat{\theta}=\frac{\hat\lambda_1}{\sum_{j=1}^5\hat\lambda_j}\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(bootstrap<span class="sc">::</span>scor)</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> <span class="fu">cov</span>(data[<span class="sc">-</span>i,])</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">eigen</span>(sigma)<span class="sc">$</span>values)</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> lambda[<span class="fu">length</span>(lambda)]<span class="sc">/</span><span class="fu">sum</span>(lambda) <span class="co">#jackknife process</span></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>}</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">eigen</span>(<span class="fu">cov</span>(data))<span class="sc">$</span>values)               <span class="co">#sort eigen </span></span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> lambda[<span class="fu">length</span>(lambda)]<span class="sc">/</span><span class="fu">sum</span>(lambda)       <span class="co">#\hat\theta</span></span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)       <span class="co">#bias</span></span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>)) <span class="co">#standard error</span></span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">5</span>) <span class="co">#display bias &amp; se</span></span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##   0.61912   0.00107   0.04955</code></pre>
</div>
<div id="exercise-7.11" class="section level2">
<h2><strong>Exercise 7.11</strong></h2>
<p><strong>Question</strong><br />
In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<p><strong>Answer</strong><br />
leave-two-out 表示对于<span class="math inline">\((x_k,y_k),k=1,2,...,n\)</span>，分别舍弃两点<span class="math inline">\((x_i,y_i),(x_j,y_j),i\ne
j\)</span>，后使用剩下的n-2个点进行拟合比较，使用嵌套循环完成，如下.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) </span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>n,<span class="at">ncol=</span>n)</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n<span class="dv">-1</span>) {</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){       <span class="co">#i \ne j</span></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">c</span>(i,j)</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]       <span class="co">#leave-two-out samples</span></span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>    </span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)         <span class="co">#model 1</span></span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>    e1[i,j] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>    </span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))<span class="co">#model 2</span></span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>    e2[i,j] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a>    </span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)    <span class="co">#model 3</span></span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb72-22"><a href="#cb72-22" tabindex="-1"></a>    e3[i,j] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb72-23"><a href="#cb72-23" tabindex="-1"></a>    </span>
<span id="cb72-24"><a href="#cb72-24" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))<span class="co">#model 4</span></span>
<span id="cb72-25"><a href="#cb72-25" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb72-26"><a href="#cb72-26" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb72-27"><a href="#cb72-27" tabindex="-1"></a>    e4[i,j] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb72-28"><a href="#cb72-28" tabindex="-1"></a>  }</span>
<span id="cb72-29"><a href="#cb72-29" tabindex="-1"></a>}</span>
<span id="cb72-30"><a href="#cb72-30" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1,<span class="at">na.rm=</span>T), <span class="fu">mean</span>(e2,<span class="at">na.rm=</span>T), <span class="fu">mean</span>(e3,<span class="at">na.rm=</span>T), <span class="fu">mean</span>(e4,<span class="at">na.rm=</span>T))  <span class="co">#average squared prediction error</span></span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>J2  <span class="co">#model 2</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    25.22190     -1.43158      0.05408</code></pre>
<p>经比较，模型（2）的leave-two-out预测误差最小，故选择模型（2）.
即<span class="math display">\[\hat{Y}=22.22190-1.43158X+0.05408X^2  \]</span><br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw6" class="section level1">
<h1><strong>HW6</strong></h1>
<div id="exercise-1-3" class="section level2">
<h2><strong>Exercise 1</strong></h2>
<p><strong>Question</strong><br />
Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<p><strong>Answer</strong><br />
In continuous situation, the proposal distribution(pdf): <span class="math inline">\(g(r|s)\)</span><br />
Transition kernel<br />
<span class="math display">\[\begin{align*}
\begin{split}
K(r,s)= \left \{
\begin{array}{ll}
    \alpha(r,s)g(s|r),                    &amp; s\ne r\\
    1-\int \alpha(r,s)g(s|r),     &amp; s=r\\
\end{array}
\right.
\end{split}
\end{align*}\]</span> where the acceptance probability is <span class="math inline">\(\alpha(s,r)=min\left\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\right\}\)</span>.<br />
If the equation <span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span> holds, the
stationarity of Metropolis-Hastings sampler algorithm is proved.<br />
(i) when <span class="math inline">\(s=r\)</span>, the equation holds
surely.<br />
(ii) when <span class="math inline">\(s\ne r\)</span>,<br />
<span class="math display">\[
K(s,r)f(s)=\alpha(s,r)g(r|s)f(s)=min\left\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\right\}g(r|s)f(s)
\\
=\left\{
\begin{aligned}
g(r|s)f(s) ,&amp; &amp; f(r)g(s|r)\ge f(s)g(r|s) \\
g(s|r)f(r) ,&amp; &amp; f(r)g(s|r)&lt; f(s)g(r|s) \\
\end{aligned}
\right.
\]</span> <span class="math display">\[
K(r,s)f(r)=\alpha(r,s)g(s|r)f(r)=min\left\{\frac{f(s)g(r|s)}{f(r)g(s|r)},1\right\}g(s|r)f(r)
\\
=\left\{
\begin{aligned}
g(r|s)f(s) &amp; &amp; f(r)g(s|r)\ge f(s)g(r|s) \\
g(s|r)f(r) &amp; &amp; f(r)g(s|r)&lt; f(s)g(r|s) \\
\end{aligned}
\right.
\]</span> From (i) and (ii), the stationary equation <span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span> holds.</p>
</div>
<div id="exercise-8.1" class="section level2">
<h2><strong>Exercise 8.1</strong></h2>
<p><strong>Question</strong><br />
Implement the two-sample Cramer-von Mises test for equal distributions
as a permutation test. Apply the test to the data in Examples 8.1 and
8.2.</p>
<p><strong>Answer</strong><br />
In Example 8.1, the data is soybean and linseed implements from
chickwts; In Example 8.2, the data is sunflower and linseed implements
Two-sample Cramer-von Mises statistic： <span class="math display">\[W_2=\frac{mn}{(m+n)^2}[\sum^n_{i=1}(F_n(x_i)-G_m(x_i))^2+\sum^m_{j=1}(F_n(y_i)-G_m(y_i))^2]\]</span>
where <span class="math inline">\(F_n(x_i)=\frac{1}{n}\sum_{j=1}^nI(X_j&lt;x_i)\)</span>：the
ecdf of the sample <span class="math inline">\(x_1,...,x_n\)</span>；<span class="math inline">\(G_m\)</span>：the ecdf of the sample <span class="math inline">\(y_1,...,y_m\)</span>. suppose that <span class="math inline">\(H_0:F=G\)</span> vs <span class="math inline">\(H_1:F \ne G\)</span></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)            <span class="co">#load data</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">formula</span>(chickwts))  <span class="co">#graphical summary</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>])</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>])</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>      <span class="co">#repeat times</span></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>CVM <span class="ot">&lt;-</span>  <span class="cf">function</span>(x1,x2){</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x1)</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x2)</span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n<span class="sc">+</span>m</span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>  k0 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>N <span class="co">#index</span></span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x1, x2)  <span class="co">#pooled sample</span></span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> Gm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a>  </span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a>  <span class="co">#W2 statistic</span></span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a>    Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> x1))</span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a>    Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> x2))</span>
<span id="cb77-19"><a href="#cb77-19" tabindex="-1"></a>  }</span>
<span id="cb77-20"><a href="#cb77-20" tabindex="-1"></a>  W2 <span class="ot">&lt;-</span> m<span class="sc">*</span>n<span class="sc">/</span>N<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((Fn<span class="sc">-</span>Gm)<span class="sc">^</span><span class="dv">2</span>)  </span>
<span id="cb77-21"><a href="#cb77-21" tabindex="-1"></a>  </span>
<span id="cb77-22"><a href="#cb77-22" tabindex="-1"></a>  <span class="co">#W2* statitic from permutation</span></span>
<span id="cb77-23"><a href="#cb77-23" tabindex="-1"></a>  W2star <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb77-24"><a href="#cb77-24" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb77-25"><a href="#cb77-25" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(k0)</span>
<span id="cb77-26"><a href="#cb77-26" tabindex="-1"></a>    zstar <span class="ot">&lt;-</span> z[k]</span>
<span id="cb77-27"><a href="#cb77-27" tabindex="-1"></a>    x1star <span class="ot">&lt;-</span> zstar[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb77-28"><a href="#cb77-28" tabindex="-1"></a>    x2star <span class="ot">&lt;-</span> zstar[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]  </span>
<span id="cb77-29"><a href="#cb77-29" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb77-30"><a href="#cb77-30" tabindex="-1"></a>      Fn[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(zstar[j] <span class="sc">&lt;=</span> x1star))</span>
<span id="cb77-31"><a href="#cb77-31" tabindex="-1"></a>      Gm[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(zstar[j] <span class="sc">&lt;=</span> x2star))</span>
<span id="cb77-32"><a href="#cb77-32" tabindex="-1"></a>    }</span>
<span id="cb77-33"><a href="#cb77-33" tabindex="-1"></a>    W2star[i] <span class="ot">&lt;-</span> m<span class="sc">*</span>n<span class="sc">/</span>N<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>((Fn<span class="sc">-</span>Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb77-34"><a href="#cb77-34" tabindex="-1"></a>  }</span>
<span id="cb77-35"><a href="#cb77-35" tabindex="-1"></a>  W2star <span class="ot">&lt;-</span> <span class="fu">c</span>(W2star,W2)</span>
<span id="cb77-36"><a href="#cb77-36" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(W2star<span class="sc">&gt;=</span>W2)</span>
<span id="cb77-37"><a href="#cb77-37" tabindex="-1"></a>  <span class="fu">return</span>(p) <span class="co">#p.value</span></span>
<span id="cb77-38"><a href="#cb77-38" tabindex="-1"></a>}</span>
<span id="cb77-39"><a href="#cb77-39" tabindex="-1"></a><span class="fu">CVM</span>(x1,x2)  <span class="co">#Example 8.1</span></span></code></pre></div>
<pre><code>## [1] 0.411</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">CVM</span>(x2,x3)  <span class="co">#Example 8.2</span></span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<p>Given the significant level <span class="math inline">\(\alpha=0.05\)</span>, in example 8.1, according to
p.value &gt; 0.05, there is no evidence for rejecting the null
hypothesis. Thus, there is no significant difference between the
distribution of soybean and linseed implements; However, in example 8.2,
the p.value &lt; 0.05, thus we can reject the null hypothesis, deeming
that there is a significant difference between the distribution of
sunflower and linseed implements.</p>
</div>
<div id="exercise-8.3" class="section level2">
<h2><strong>Exercise 8.3</strong></h2>
<p><strong>Question</strong><br />
The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<p><strong>Answer</strong><br />
1. Function</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>  <span class="co">#repeat times</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>}</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>Count5 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n<span class="sc">+</span>m</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>    zstar <span class="ot">&lt;-</span> z[k]</span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a>    xstar <span class="ot">&lt;-</span> zstar[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a>    ystar <span class="ot">&lt;-</span> zstar[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a>    <span class="fu">maxout</span>(xstar, ystar)</span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a>    })</span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="fu">maxout</span>(x, y)</span>
<span id="cb81-22"><a href="#cb81-22" tabindex="-1"></a>  statstar <span class="ot">&lt;-</span> <span class="fu">c</span>(stats, stat)</span>
<span id="cb81-23"><a href="#cb81-23" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estimate =</span> stat, <span class="at">p =</span> <span class="fu">mean</span>(statstar<span class="sc">&gt;=</span>stat)))</span>
<span id="cb81-24"><a href="#cb81-24" tabindex="-1"></a> }</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>practice</li>
</ol>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co">#unequal sample sizes </span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a><span class="co">#1.equal variance</span></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a><span class="fu">Count5</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 6
## 
## $p
## [1] 0.207</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="co">#2. unequal variance </span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a><span class="fu">Count5</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 16
## 
## $p
## [1] 0.002</code></pre>
<p>Given the significant level <span class="math inline">\(\alpha=0.05\)</span>, in example 1, p.value &gt;
0.05, thus there is no evidence for rejecting the null hypothesis that
the variance are significantly different. In example 2, however, p.value
&lt; 0.05, so that we can reject the null hypothesis, deeming that there
is a significant difference in variance of these two sample.<br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw7" class="section level1">
<h1><strong>HW7</strong></h1>
<div id="exercise-1-4" class="section level2">
<h2><strong>Exercise 1</strong></h2>
<p><strong>Answer</strong><br />
1.function</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>Model <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){  </span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, <span class="dv">1</span>)</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>    x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N, <span class="dv">1</span>)</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>    x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>    }</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>))</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>  <span class="fu">return</span>(solution)</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>}</span></code></pre></div>
<p>2.call function</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>N <span class="ot">=</span> <span class="fl">10e6</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>b3 <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>f0 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span><span class="dv">4</span>,<span class="at">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> f0){</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>  x[k,] <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">Model</span>(N,b1,b2,b3,i))</span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb87-12"><a href="#cb87-12" tabindex="-1"></a>}</span>
<span id="cb87-13"><a href="#cb87-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> x[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>), drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb87-14"><a href="#cb87-14" tabindex="-1"></a><span class="fu">colnames</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;root&quot;</span>, <span class="st">&quot;f.root&quot;</span>, <span class="st">&quot;iter&quot;</span>)</span>
<span id="cb87-15"><a href="#cb87-15" tabindex="-1"></a><span class="fu">rownames</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;f0=0.1&quot;</span>, <span class="st">&quot;f0=0.01&quot;</span>, <span class="st">&quot;f0=0.001&quot;</span>,<span class="st">&quot;f0=0.0001&quot;</span>)</span>
<span id="cb87-16"><a href="#cb87-16" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##                 root        f.root iter
## f0=0.1     -3.166666  4.011400e-05   14
## f0=0.01    -6.071029  1.719595e-05   16
## f0=0.001   -8.724788 -2.821307e-07   18
## f0=0.0001 -11.278029  7.766377e-07   15</code></pre>
<p>3.plot</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="sc">-</span><span class="fu">log</span>(f0), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-9.4" class="section level2">
<h2><strong>Exercise 9.4</strong></h2>
<p><strong>Answer</strong><br />
The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>.Because the
proposal distribution is normal distribution, which is symmetric, so the
the acceptance rates turns to <span class="math inline">\(\alpha(X_t,Y)=min\left \{ 1 ,\frac{f(Y)}{f(X_t)}
\right \}\)</span></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>rw.Laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(N, x0, sigma) {</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>  update_value <span class="ot">&lt;-</span> <span class="cf">function</span>(i, xt, sigma, u) {</span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma)</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a>    <span class="fu">ifelse</span>(u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(xt) <span class="sc">-</span> <span class="fu">abs</span>(y)), y, xt)</span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a>  }</span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb90-12"><a href="#cb90-12" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">update_value</span>(i, x[i <span class="sc">-</span> <span class="dv">1</span>], sigma, u)</span>
<span id="cb90-13"><a href="#cb90-13" tabindex="-1"></a>  }</span>
<span id="cb90-14"><a href="#cb90-14" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sum</span>(x[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">==</span> x[<span class="sc">-</span>N])</span>
<span id="cb90-16"><a href="#cb90-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">k =</span> k))</span>
<span id="cb90-17"><a href="#cb90-17" tabindex="-1"></a>}</span>
<span id="cb90-18"><a href="#cb90-18" tabindex="-1"></a></span>
<span id="cb90-19"><a href="#cb90-19" tabindex="-1"></a>run_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(N, x0, sigmas) {</span>
<span id="cb90-20"><a href="#cb90-20" tabindex="-1"></a>  simulations <span class="ot">&lt;-</span> <span class="fu">lapply</span>(sigmas, <span class="cf">function</span>(sigma) <span class="fu">rw.Laplace</span>(N, x0, sigma))</span>
<span id="cb90-21"><a href="#cb90-21" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb90-22"><a href="#cb90-22" tabindex="-1"></a>    <span class="at">k_values =</span> <span class="fu">sapply</span>(simulations, <span class="cf">function</span>(sim) sim<span class="sc">$</span>k),</span>
<span id="cb90-23"><a href="#cb90-23" tabindex="-1"></a>    <span class="at">x_values =</span> <span class="fu">lapply</span>(simulations, <span class="cf">function</span>(sim) sim<span class="sc">$</span>x)</span>
<span id="cb90-24"><a href="#cb90-24" tabindex="-1"></a>  )</span>
<span id="cb90-25"><a href="#cb90-25" tabindex="-1"></a>}</span>
<span id="cb90-26"><a href="#cb90-26" tabindex="-1"></a></span>
<span id="cb90-27"><a href="#cb90-27" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">5e3</span></span>
<span id="cb90-28"><a href="#cb90-28" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>)</span>
<span id="cb90-29"><a href="#cb90-29" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb90-30"><a href="#cb90-30" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">run_simulation</span>(N, x0, sigma)</span>
<span id="cb90-31"><a href="#cb90-31" tabindex="-1"></a><span class="fu">print</span>(results<span class="sc">$</span>k_values<span class="sc">/</span>N)  </span></code></pre></div>
<pre><code>## [1] 0.1780 0.3044 0.6604 0.8960</code></pre>
<p>With the increase of the variance of that are used for the proposal
distribution, the rejection rates increases strictly.<br />
Also, we can compare these four chains in plots.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> results<span class="sc">$</span>x_values[[<span class="dv">1</span>]]</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> results<span class="sc">$</span>x_values[[<span class="dv">2</span>]]</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> results<span class="sc">$</span>x_values[[<span class="dv">3</span>]]</span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> results<span class="sc">$</span>x_values[[<span class="dv">4</span>]]</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">2e3</span></span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a><span class="fu">plot</span>(y1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">plot</span>(y2, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">plot</span>(y3, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">plot</span>(y4, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co">#throw buin-in sample</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">100</span>)<span class="co">#QQ plots</span></span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">qexp</span>(p, <span class="dv">1</span>)</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(y), y)</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y1[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], p)</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a><span class="fu">qqplot</span>(z, Q1, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>Q2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y2[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], p)</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="fu">qqplot</span>(z, Q2, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y3[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], p)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="fu">qqplot</span>(z, Q3, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>Q4 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y4[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], p)</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a><span class="fu">qqplot</span>(z, Q4, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(z))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a><span class="fu">hist</span>(y1[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a><span class="fu">lines</span>(z, fx)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">hist</span>(y2[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">lines</span>(z, fx)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">hist</span>(y3[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="fu">lines</span>(z, fx)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">hist</span>(y4[(b <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="fu">lines</span>(z, fx)</span></code></pre></div>
<p><img src="data:image/png;base64,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50bjTNyypeiQwkQHJEvTuTPasc72H9XXuAD5FyYmIPludnW5evWO+l3unRvxnZ7jSpzrQJdjEB6FqRTbg1TIjIdXe20m25XY4UHehSlHGCiK7sCKm0HaLT38pzOxayTtWRih+FONwmPqULWOfuOgzsTOqYZfYYRosgpEgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEFAagMRz9N2SydCCx+74nd3Hv5fl/pV+HG9efJ/d/X/T84G+p5IAJEN2dcjqojvAab+WRAodmXDYqAAzQdgr8rO3UgCkQnYlFxHB0wWo0LtfcUeTvx82L2U41BwByddx5vJDhuxKLiK4abf8emkHqVgRYYUJWRORPiIak/8vTcwRUCEjTh+rkF0JSFDbLXlNrdioZsicBqRpcEAybGyOgGRr4nU3IbsCkHydqWJTx8M7Ael2KLzIhLTODZDwFlE3Uz8F6NHUXVdXfPukEY+pAek3w6pmtponIF7VbFWH7Aouko3ymNpvnB5kAZKG5gho/+qnV9s6ZNftQWUPQGW2miWgw+ZvJs7S1QdVMZioDxIp7ucIyIoCP72LFW0R0Cd3MXk+myWg2jWy03FQ22DxZBwkftuv5wnoUzuSuRpJ95Er3fwA5Y2Q7mou1keFI0p8boB2y2Ylq9l8j3Or2Xytw5xn8ymLAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgP4E6b2GgSAes0gAAAAASUVORK5CYII=" /><!-- --><br />
From these three plots (lines plot, qq plots and histogram plots), We
can conclude that when <span class="math inline">\(\sigma=1,4\)</span>,
the chains are converging to the target distribution more likely.</p>
</div>
<div id="exercise-9.7" class="section level2">
<h2><strong>Exercise 9.7</strong></h2>
<p><strong>Answer</strong><br />
1.Gibbs sampler</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">5e3</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma1</span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma2</span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a>generate_observation <span class="ot">&lt;-</span> <span class="cf">function</span>(x_prev, mu1, mu2, rho, sigma1, sigma2, s1, s2) {</span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x_prev[<span class="dv">2</span>] <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1 <span class="sc">/</span> sigma2 <span class="co">#conditional mean</span></span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2 <span class="sc">/</span> sigma1</span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb104-14"><a href="#cb104-14" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(x1, x2))</span>
<span id="cb104-15"><a href="#cb104-15" tabindex="-1"></a>}</span>
<span id="cb104-16"><a href="#cb104-16" tabindex="-1"></a></span>
<span id="cb104-17"><a href="#cb104-17" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb104-18"><a href="#cb104-18" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb104-19"><a href="#cb104-19" tabindex="-1"></a></span>
<span id="cb104-20"><a href="#cb104-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb104-21"><a href="#cb104-21" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> <span class="fu">generate_observation</span>(X[i <span class="sc">-</span> <span class="dv">1</span>, ], mu1, mu2, rho, sigma1, sigma2, s1, s2)</span>
<span id="cb104-22"><a href="#cb104-22" tabindex="-1"></a>}</span>
<span id="cb104-23"><a href="#cb104-23" tabindex="-1"></a></span>
<span id="cb104-24"><a href="#cb104-24" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, ]</span>
<span id="cb104-25"><a href="#cb104-25" tabindex="-1"></a>X <span class="ot">&lt;-</span> x[, <span class="dv">1</span>]</span>
<span id="cb104-26"><a href="#cb104-26" tabindex="-1"></a>Y <span class="ot">&lt;-</span> x[, <span class="dv">2</span>]</span>
<span id="cb104-27"><a href="#cb104-27" tabindex="-1"></a><span class="fu">plot</span>(X, Y,<span class="at">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
From the plot, we can see a high correlation between X and Y. And the
summary of the fitted model suggest that the coefficient fits our
target.<br />
</p>
<p>2.residual</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a><span class="fu">summary</span>(M)<span class="co">#model</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4947 -0.2999 -0.0005  0.3021  1.5080 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.009487   0.007082    1.34     0.18    
## X           0.903224   0.006962  129.74   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.446 on 3998 degrees of freedom
## Multiple R-squared:  0.8081, Adjusted R-squared:  0.808 
## F-statistic: 1.683e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">qqnorm</span>(M<span class="sc">$</span>res)<span class="co">#Normality</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a><span class="fu">qqline</span>(M<span class="sc">$</span>res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">plot</span>(M<span class="sc">$</span>fit, M<span class="sc">$</span>res, <span class="at">cex =</span> <span class="fl">0.5</span>) <span class="co">#constant</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
From the plots of residual, we can conclude that the residual of the
fitted model is consistent with normality and also a constant, which is
independent of x.</p>
</div>
<div id="exercise-9.10" class="section level2">
<h2><strong>Exercise 9.10</strong></h2>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<pre><code>## Warning: package &#39;coda&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)</span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)</span>
<span id="cb111-10"><a href="#cb111-10" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat<span class="sc">/</span>W</span>
<span id="cb111-11"><a href="#cb111-11" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb111-12"><a href="#cb111-12" tabindex="-1"></a> }</span>
<span id="cb111-13"><a href="#cb111-13" tabindex="-1"></a></span>
<span id="cb111-14"><a href="#cb111-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb111-15"><a href="#cb111-15" tabindex="-1"></a>  <span class="cf">if</span> (sigma <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb111-16"><a href="#cb111-16" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;error set&quot;</span>)</span>
<span id="cb111-17"><a href="#cb111-17" tabindex="-1"></a>  }</span>
<span id="cb111-18"><a href="#cb111-18" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb111-19"><a href="#cb111-19" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb111-20"><a href="#cb111-20" tabindex="-1"></a>  }</span>
<span id="cb111-21"><a href="#cb111-21" tabindex="-1"></a>  result <span class="ot">&lt;-</span> (x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb111-22"><a href="#cb111-22" tabindex="-1"></a>  result</span>
<span id="cb111-23"><a href="#cb111-23" tabindex="-1"></a>}</span>
<span id="cb111-24"><a href="#cb111-24" tabindex="-1"></a></span>
<span id="cb111-25"><a href="#cb111-25" tabindex="-1"></a>Rayleigh.MH.chain1 <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, m, x0) {</span>
<span id="cb111-26"><a href="#cb111-26" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb111-27"><a href="#cb111-27" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb111-28"><a href="#cb111-28" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb111-29"><a href="#cb111-29" tabindex="-1"></a></span>
<span id="cb111-30"><a href="#cb111-30" tabindex="-1"></a>  <span class="co">#generate chain</span></span>
<span id="cb111-31"><a href="#cb111-31" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb111-32"><a href="#cb111-32" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb111-33"><a href="#cb111-33" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb111-34"><a href="#cb111-34" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb111-35"><a href="#cb111-35" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb111-36"><a href="#cb111-36" tabindex="-1"></a>    accept_ratio <span class="ot">&lt;-</span> num <span class="sc">/</span> den</span>
<span id="cb111-37"><a href="#cb111-37" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> accept_ratio) {</span>
<span id="cb111-38"><a href="#cb111-38" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb111-39"><a href="#cb111-39" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb111-40"><a href="#cb111-40" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb111-41"><a href="#cb111-41" tabindex="-1"></a>    }</span>
<span id="cb111-42"><a href="#cb111-42" tabindex="-1"></a>  }</span>
<span id="cb111-43"><a href="#cb111-43" tabindex="-1"></a>  x</span>
<span id="cb111-44"><a href="#cb111-44" tabindex="-1"></a>}</span>
<span id="cb111-45"><a href="#cb111-45" tabindex="-1"></a></span>
<span id="cb111-46"><a href="#cb111-46" tabindex="-1"></a><span class="co">#set</span></span>
<span id="cb111-47"><a href="#cb111-47" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb111-48"><a href="#cb111-48" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span>sigma, sigma<span class="sc">^</span><span class="dv">2</span>, sigma<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb111-49"><a href="#cb111-49" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb111-50"><a href="#cb111-50" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">2e3</span></span>
<span id="cb111-51"><a href="#cb111-51" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> m)</span>
<span id="cb111-52"><a href="#cb111-52" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) X[i, ] <span class="ot">=</span> <span class="fu">Rayleigh.MH.chain1</span>(sigma, m,x0[i])</span>
<span id="cb111-53"><a href="#cb111-53" tabindex="-1"></a>psi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb111-54"><a href="#cb111-54" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) psi[i, ] <span class="ot">=</span> psi[i, ]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb111-55"><a href="#cb111-55" tabindex="-1"></a>rhat<span class="ot">=</span><span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb111-56"><a href="#cb111-56" tabindex="-1"></a>rhat</span></code></pre></div>
<pre><code>## [1] 1.118</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="co"># use the coda package to check for convergence of the chain</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>mcmc_chains <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(i) <span class="fu">as.mcmc</span>(X[i, ]))</span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(mcmc_chains)</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gelman.diag</span>(Y))</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.01       1.02</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(Y, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><br />
From the plot, we can conclude that after 1000 iterations, the chain
converges with Gelman-Rubin Statistic converges.<br />
<br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw8" class="section level1">
<h1><strong>HW8</strong></h1>
<div id="exercise-1-5" class="section level2">
<h2><strong>Exercise 1</strong></h2>
<p><strong>Answer</strong><br />
1.theoretical For known interval, we get MLE as follows: <span class="math display">\[\begin{align}
  lnL(\lambda) &amp;= \pi^n_{i=1}P_{\lambda}(u_i≤X_i≤v_i) \\
    &amp;= \sum^n_{i=1} ln(e^{-\lambda u_i}-e^{-\lambda v_i})\\
\end{align}\]</span> Thus,<span class="math inline">\(\lambda\)</span>
satisfy the equation: <span class="math display">\[\frac{\partial
lnL(\lambda)}{\partial \lambda}=\sum_{i=1}^n \frac{ -u_ie^{-\lambda
u_i+\lambda v_i}+v_i}{e^{-\lambda u_i+\lambda v_i}-1}=0\]</span> EM
algorithm:Let hidden variable <span class="math inline">\(Z_i\)</span>
be the specific value, thus: <span class="math display">\[\hat{\lambda}=argmax_{\lambda}E(\ln l(\lambda)|\{
u_i, v_i\})=\frac{n}{\sum_{i=1}^{n}E(z_i|\{ u_i, v_i\})}\]</span> From
calculation,In <span class="math inline">\(\lambda_t=f(\lambda_t-1)=\frac{n\lambda_{t-1}}{n-\lambda_{t-1}\ln
f&#39;(\lambda_{t-1})}\)</span>,the <span class="math inline">\(f\)</span> has a non-zero derivative at the fixed
point MLE estimator, then EM algorithm converges linearly.<br />
2.practice</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>u<span class="ot">=</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>v<span class="ot">=</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>eps<span class="ot">=</span><span class="fl">10e-1</span></span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>lam<span class="ot">=</span><span class="fl">0.7</span></span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>flag<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(flag)<span class="sc">&gt;</span>eps)</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a>{</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a>  lam1<span class="ot">=</span>lam<span class="sc">-</span>(<span class="fu">sum</span>(v<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(lam)))<span class="sc">/</span><span class="fu">sum</span>(<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(lam))</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a>  flag<span class="ot">=</span>lam1<span class="sc">-</span>lam</span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a>  lam<span class="ot">=</span>lam1</span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a>}</span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a>lam <span class="co">#MLE</span></span></code></pre></div>
<pre><code>## [1] 0.7</code></pre>
<p>From calculation,using N-R algorithm we can know <span class="math inline">\(\lambda_{t}=\frac{n\lambda_{t-1}}{n-\lambda_{t-1}\ln
f&#39;(\lambda_{t-1})}\)</span>,thus</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>eps<span class="ot">=</span><span class="fl">10e-1</span></span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>lamb<span class="ot">=</span><span class="fl">0.7</span></span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>flag<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">abs</span>(flag)<span class="sc">&gt;</span>eps)</span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>{</span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a>  lam1<span class="ot">=</span>n<span class="sc">*</span>lam<span class="sc">/</span>(n<span class="sc">-</span>lam<span class="sc">*</span><span class="fu">sum</span>((v<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(lam))<span class="sc">/</span>(<span class="fu">exp</span>(lam)<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a>  flag<span class="ot">=</span>lam1<span class="sc">-</span>lam</span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a>  lam<span class="ot">=</span>lam1</span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a>}</span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a>lam <span class="co">#EM</span></span></code></pre></div>
<pre><code>## [1] 0.7</code></pre>
</div>
<div id="exercises-11.8" class="section level2">
<h2><strong>Exercises 11.8</strong></h2>
<p><strong>Answer</strong><br />
Simply put, in a 3-finger Mora game, each player will display 1, 2, or 3
fingers, and each player will guess the number of fingers the opponent
will display. If both players guess correctly, this game is a draw.If
one player guesses correctly, they will win an amount equivalent to the
sum of two players ’ fingers. As shown in the reference book,The
Statistical Computing with R, we get code as follows. 1.function</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A</span>
<span id="cb120-4"><a href="#cb120-4" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb120-5"><a href="#cb120-5" tabindex="-1"></a>A <span class="ot">&lt;-</span> A<span class="sc">/</span><span class="fu">max</span>(A)</span>
<span id="cb120-6"><a href="#cb120-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb120-7"><a href="#cb120-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb120-8"><a href="#cb120-8" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb120-9"><a href="#cb120-9" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>)</span>
<span id="cb120-10"><a href="#cb120-10" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n))</span>
<span id="cb120-11"><a href="#cb120-11" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb120-12"><a href="#cb120-12" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>)))</span>
<span id="cb120-13"><a href="#cb120-13" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb120-14"><a href="#cb120-14" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3,</span>
<span id="cb120-15"><a href="#cb120-15" tabindex="-1"></a><span class="at">maxi =</span> <span class="cn">TRUE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb120-16"><a href="#cb120-16" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)</span>
<span id="cb120-17"><a href="#cb120-17" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))</span>
<span id="cb120-18"><a href="#cb120-18" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb120-19"><a href="#cb120-19" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>)))</span>
<span id="cb120-20"><a href="#cb120-20" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb120-21"><a href="#cb120-21" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3,</span>
<span id="cb120-22"><a href="#cb120-22" tabindex="-1"></a><span class="at">maxi =</span> <span class="cn">FALSE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb120-23"><a href="#cb120-23" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">A =</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A, <span class="at">x =</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb120-24"><a href="#cb120-24" tabindex="-1"></a><span class="at">y =</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n], <span class="at">v =</span> sx<span class="sc">$</span>soln[m <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span>min.A)</span>
<span id="cb120-25"><a href="#cb120-25" tabindex="-1"></a>soln</span>
<span id="cb120-26"><a href="#cb120-26" tabindex="-1"></a>}</span></code></pre></div>
<p>2.payoff matrix:let B = A + 2</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">3</span>,</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a><span class="dv">0</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">5</span>,</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>,</span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb121-8"><a href="#cb121-8" tabindex="-1"></a>B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb121-9"><a href="#cb121-9" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb121-10"><a href="#cb121-10" tabindex="-1"></a>s<span class="sc">$</span>v</span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="fu">round</span>(s<span class="sc">$</span>x <span class="sc">*</span> <span class="dv">61</span>, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x1 x2 x3 x4 x5 x6 x7 x8 x9 
##  0  0 25  0 20  0 16  0  0</code></pre>
<p>As the results show, <span class="math inline">\(v=2\)</span>,and the
it is one of the extreme points (11.15) of the original game A.<br />
<br />
<br />
<br />
</p>
</div>
</div>
<div id="hw9" class="section level1">
<h1><strong>HW9</strong></h1>
<div id="exercise-4" class="section level2">
<h2><strong>2.1.3 Exercise 4</strong></h2>
<p><strong>Question</strong><br />
Why do you need to use unlist() to convert a list to an atomic vector?
Why doesn’t as.vector() work?<br />
<strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&#39;a&#39;</span>,<span class="dv">1</span>,<span class="fl">1.5</span>)</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">unlist</span>(a))</span></code></pre></div>
<pre><code>##  chr [1:3] &quot;a&quot; &quot;1&quot; &quot;1.5&quot;</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">as.vector</span>(a))</span></code></pre></div>
<pre><code>## List of 3
##  $ : chr &quot;a&quot;
##  $ : num 1
##  $ : num 1.5</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;1&#39;</span>,<span class="st">&#39;2&#39;</span>,<span class="dv">3</span>)</span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">as.vector</span>(b))</span></code></pre></div>
<pre><code>##  chr [1:3] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<p>Because unlist() can turn a list with different types into an atomic
vector with the highest order type , while as.vector() doesn’t change
its types ( as.vector() doesn’t work on a list ).</p>
</div>
<div id="exercise-1-6" class="section level2">
<h2><strong>2.3.1 Exercise 1</strong></h2>
<p><strong>Question</strong><br />
What does dim() return when applied to a vector?<br />
<strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a><span class="fu">dim</span>(a)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Return ‘NULL’. Because a vector in R does not have the attribute of
dimension.</p>
</div>
<div id="exercise-2-1" class="section level2">
<h2><strong>2.3.1 Exercise 2</strong></h2>
<p><strong>Question</strong><br />
If is.matrix(x) is TRUE , what will is.array(x) return?<br />
<strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>()</span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a><span class="fu">is.matrix</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="fu">is.array</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Return TRUE. In R, a matrix is technically a special case (a
2-dimensional array) of an array.</p>
</div>
<div id="exercise-2-2" class="section level2">
<h2><strong>2.4.5 Exercise 2</strong></h2>
<p><strong>Question</strong><br />
What does as.matrix() do when applied to a data frame with columns of
different types?<br />
<strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),      </span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>), </span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>  <span class="at">C =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>)</span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a>)</span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(df)</span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a><span class="fu">print</span>(m)</span></code></pre></div>
<pre><code>##      A   B   C    
## [1,] &quot;1&quot; &quot;a&quot; &quot;1.5&quot;
## [2,] &quot;2&quot; &quot;b&quot; &quot;2.5&quot;
## [3,] &quot;3&quot; &quot;c&quot; &quot;3.5&quot;</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="fu">str</span>(m)</span></code></pre></div>
<pre><code>##  chr [1:3, 1:3] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;1.5&quot; &quot;2.5&quot; &quot;3.5&quot;
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr [1:3] &quot;A&quot; &quot;B&quot; &quot;C&quot;</code></pre>
<p>It turns the data frame into a matrix where all elements are of a
single type of the highest order.</p>
</div>
<div id="exercise-3" class="section level2">
<h2><strong>2.4.5 Exercise 3</strong></h2>
<p><strong>Question</strong><br />
Can you have a data frame with 0 rows? What about 0 columns?<br />
<strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="co">#data frame with 0 rows</span></span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a>df1<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">numeric</span>(), <span class="at">B =</span> <span class="fu">character</span>(), <span class="at">C =</span> <span class="fu">integer</span>())</span>
<span id="cb143-3"><a href="#cb143-3" tabindex="-1"></a></span>
<span id="cb143-4"><a href="#cb143-4" tabindex="-1"></a><span class="co">#data frame with 0 columns</span></span>
<span id="cb143-5"><a href="#cb143-5" tabindex="-1"></a>df2<span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb143-6"><a href="#cb143-6" tabindex="-1"></a></span>
<span id="cb143-7"><a href="#cb143-7" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(df1))</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  3 variables:
##  $ A: num 
##  $ B: chr 
##  $ C: int 
## NULL</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(df2))</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    0 obs. of  0 variables
## NULL</code></pre>
<p>yes, it’s possible.<br />
A data frame with 0 rows is essentially an empty data frame with a
structure defined by its columns and their types, but without any actual
data; a data frame with 0 columns does not hold any data or
structure.</p>
</div>
<div id="exercises-2" class="section level2">
<h2><strong>Exercises 2</strong></h2>
<p><strong>Question</strong><br />
The function below scales a vector so it falls in the range [0,1]. How
would you apply it to every column of a data frame? How would you apply
it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>scale01 <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>         rng <span class="ot">=</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a>         (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb147-4"><a href="#cb147-4" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),      </span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>), </span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>  <span class="at">C =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>),</span>
<span id="cb148-6"><a href="#cb148-6" tabindex="-1"></a>  <span class="at">D =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>)</span>
<span id="cb148-7"><a href="#cb148-7" tabindex="-1"></a>)</span>
<span id="cb148-8"><a href="#cb148-8" tabindex="-1"></a></span>
<span id="cb148-9"><a href="#cb148-9" tabindex="-1"></a><span class="co">#1.apply it to every column of a data frame</span></span>
<span id="cb148-10"><a href="#cb148-10" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(df1, <span class="cf">function</span>(x) <span class="fu">scale01</span>(x)))  </span></code></pre></div>
<pre><code>##          X1        X2        X3
## 1 0.0000000 0.0000000 0.0000000
## 2 0.3333333 0.3333333 0.3333333
## 3 0.6666667 0.6666667 0.6666667
## 4 1.0000000 1.0000000 1.0000000</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="co">#2.apply it to every numeric column in a data frame (i.e. exclude the non-numeric columns)</span></span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(df2, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span></code></pre></div>
<pre><code>##     A B   C     D
## 1 0.0 a 0.0  TRUE
## 2 0.5 b 0.5 FALSE
## 3 1.0 c 1.0  TRUE</code></pre>
</div>
<div id="exercises-1-1" class="section level2">
<h2><strong>Exercises 1</strong></h2>
<p><strong>Question</strong><br />
Use vapply() to:<br />
a) Compute the standard deviation of every column in a numeric data
frame.<br />
b) Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)<br />
<strong>Answer</strong><br />
</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">3</span>))</span>
<span id="cb152-2"><a href="#cb152-2" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb152-3"><a href="#cb152-3" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),      </span>
<span id="cb152-4"><a href="#cb152-4" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>), </span>
<span id="cb152-5"><a href="#cb152-5" tabindex="-1"></a>  <span class="at">C =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>),</span>
<span id="cb152-6"><a href="#cb152-6" tabindex="-1"></a>  <span class="at">D =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>)</span>
<span id="cb152-7"><a href="#cb152-7" tabindex="-1"></a>)</span>
<span id="cb152-8"><a href="#cb152-8" tabindex="-1"></a></span>
<span id="cb152-9"><a href="#cb152-9" tabindex="-1"></a><span class="co">#a)</span></span>
<span id="cb152-10"><a href="#cb152-10" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">vapply</span>(df1, <span class="cf">function</span>(x) <span class="fu">sd</span>(x),<span class="fu">numeric</span>(<span class="dv">1</span>))) <span class="co">#sd</span></span></code></pre></div>
<pre><code>##    vapply.df1..function.x..sd.x...numeric.1..
## X1                                   1.290994
## X2                                   1.290994
## X3                                   1.290994</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a><span class="co">#b)</span></span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>df2b <span class="ot">&lt;-</span> df2[<span class="fu">vapply</span>(df2, <span class="cf">function</span>(x) <span class="fu">is.numeric</span>(x), <span class="fu">logical</span>(<span class="dv">1</span>))]  <span class="co">#choose numeric column</span></span>
<span id="cb154-3"><a href="#cb154-3" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">vapply</span>(df2b, <span class="cf">function</span>(x) <span class="fu">sd</span>(x), <span class="fu">numeric</span>(<span class="dv">1</span>))) <span class="co">#sd</span></span></code></pre></div>
<pre><code>##   vapply.df2b..function.x..sd.x...numeric.1..
## A                                           1
## C                                           1</code></pre>
</div>
<div id="exercises-9.8" class="section level2">
<h2><strong>Exercises 9.8</strong></h2>
<p><strong>Question</strong><br />
Consider Exercise 9.8 (pages 278, Statistical Computing with R). (Hint:
Refer to the first example of Case studies section)<br />
• Write an R function.<br />
• Write an Rcpp function.<br />
• Compare the computation time of the two functions with the function
“microbenchmark”.<br />
</p>
<p><strong>Answer</strong><br />
(1)Write an R function.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="cf">function</span>( a,b,n,N,burn ){</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="co">#initial value</span></span>
<span id="cb156-4"><a href="#cb156-4" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[<span class="dv">1</span>] <span class="sc">+</span> a, n <span class="sc">-</span> x[<span class="dv">1</span>] <span class="sc">+</span> b) </span>
<span id="cb156-5"><a href="#cb156-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){  <span class="co">#generate chain</span></span>
<span id="cb156-6"><a href="#cb156-6" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">prob =</span> y[i <span class="sc">-</span> <span class="dv">1</span>], <span class="at">size =</span> n) <span class="co">#conditional distribution</span></span>
<span id="cb156-7"><a href="#cb156-7" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i] <span class="sc">+</span> a, n <span class="sc">-</span> x[i] <span class="sc">+</span> b)</span>
<span id="cb156-8"><a href="#cb156-8" tabindex="-1"></a>  }</span>
<span id="cb156-9"><a href="#cb156-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb156-10"><a href="#cb156-10" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb156-11"><a href="#cb156-11" tabindex="-1"></a>}</span></code></pre></div>
<p>(2)Write an Rcpp function.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;std::vector&lt;int&gt; rcpp(int a, int b, int n, int N, int burn) {</span></span>
<span id="cb159-2"><a href="#cb159-2" tabindex="-1"></a><span class="st">  std::vector&lt;int&gt; x(N);</span></span>
<span id="cb159-3"><a href="#cb159-3" tabindex="-1"></a><span class="st">  std::vector&lt;double&gt; y(N);</span></span>
<span id="cb159-4"><a href="#cb159-4" tabindex="-1"></a><span class="st">  std::vector&lt;int&gt; result(N - burn);</span></span>
<span id="cb159-5"><a href="#cb159-5" tabindex="-1"></a><span class="st">  x[0] = 7;</span></span>
<span id="cb159-6"><a href="#cb159-6" tabindex="-1"></a><span class="st">  y[0] = R::rbeta(x[0] + a, n - x[0] + b);</span></span>
<span id="cb159-7"><a href="#cb159-7" tabindex="-1"></a></span>
<span id="cb159-8"><a href="#cb159-8" tabindex="-1"></a><span class="st">  for (int i = 1; i &lt; N; i++) {</span></span>
<span id="cb159-9"><a href="#cb159-9" tabindex="-1"></a><span class="st">      x[i] = R::rbinom(n, y[i - 1]);</span></span>
<span id="cb159-10"><a href="#cb159-10" tabindex="-1"></a><span class="st">      y[i] = R::rbeta(x[i] + a, n - x[i] + b);</span></span>
<span id="cb159-11"><a href="#cb159-11" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb159-12"><a href="#cb159-12" tabindex="-1"></a><span class="st">  for (int i = burn; i &lt; N; i++) {</span></span>
<span id="cb159-13"><a href="#cb159-13" tabindex="-1"></a><span class="st">      result[i - burn] = x[i];</span></span>
<span id="cb159-14"><a href="#cb159-14" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb159-15"><a href="#cb159-15" tabindex="-1"></a><span class="st">  return result;</span></span>
<span id="cb159-16"><a href="#cb159-16" tabindex="-1"></a><span class="st">}&#39;</span></span>
<span id="cb159-17"><a href="#cb159-17" tabindex="-1"></a>)</span></code></pre></div>
<p>(3)Compare the computation time of the two functions with the
function “microbenchmark”.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb160-3"><a href="#cb160-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#fixed para</span></span>
<span id="cb160-4"><a href="#cb160-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span> </span>
<span id="cb160-5"><a href="#cb160-5" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="fl">5e3</span> <span class="co">#burn-in</span></span>
<span id="cb160-6"><a href="#cb160-6" tabindex="-1"></a></span>
<span id="cb160-7"><a href="#cb160-7" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">microbenchmark</span>(<span class="fu">R</span>(a,b,n,N,burn)), <span class="fu">microbenchmark</span>(<span class="fu">rcpp</span>(a,b,n,N,burn))) <span class="co">#computation time</span></span></code></pre></div>
<pre><code>## Unit: milliseconds
##                    expr       min        lq      mean    median        uq
##     R(a, b, n, N, burn) 31.839501 41.383550 47.578776 46.570751 48.714051
##  rcpp(a, b, n, N, burn)  2.377802  2.426201  2.469203  2.459302  2.490801
##        max neval
##  91.664401   100
##   3.637001   100</code></pre>
<p>From the table, we can conclude that the Rcpp function can reduce the
computation time largely.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
